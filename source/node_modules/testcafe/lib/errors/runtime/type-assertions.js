"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.assertType = exports.is = void 0;
const lodash_1 = require("lodash");
const _1 = require("./");
const types_1 = require("../types");
const hook_1 = __importDefault(require("../../api/request-hooks/hook"));
const START_FROM_VOWEL_RE = /^[aeiou]/i;
function getIndefiniteArticle(text) {
    return START_FROM_VOWEL_RE.test(text) ? 'an' : 'a';
}
function isNonNegativeValue(value) {
    return lodash_1.isFinite(value) && value >= 0;
}
function getNumberTypeActualValueMsg(value, type) {
    if (type !== 'number')
        return type;
    if (Number.isNaN(value))
        return NaN;
    if (!lodash_1.isFinite(value))
        return Infinity;
    return value;
}
exports.is = {
    number: {
        name: 'number',
        predicate: lodash_1.isFinite,
        getActualValueMsg: getNumberTypeActualValueMsg
    },
    nonNegativeNumber: {
        name: 'non-negative number',
        predicate: isNonNegativeValue,
        getActualValueMsg: getNumberTypeActualValueMsg
    },
    nonNegativeNumberString: {
        name: 'non-negative number',
        predicate: value => isNonNegativeValue(parseInt(value, 10)),
        getActualValueMsg: value => {
            const number = parseInt(value, 10);
            return isNaN(number) ? JSON.stringify(value) : number;
        }
    },
    boolean: {
        name: 'boolean',
        predicate: (value, type) => type === 'boolean'
    },
    string: {
        name: 'string',
        predicate: (value, type) => type === 'string'
    },
    function: {
        name: 'function',
        predicate: (value, type) => type === 'function'
    },
    regExp: {
        name: 'regular expression',
        predicate: lodash_1.isRegExp
    },
    array: {
        name: 'array',
        predicate: value => Array.isArray(value)
    },
    nonNullObject: {
        name: 'non-null object',
        predicate: (value, type) => type === 'object' && !lodash_1.isNil(value),
        getActualValueMsg: (value, type) => lodash_1.isNil(value) ? String(value) : type
    },
    requestHookSubclass: {
        name: 'RequestHook subclass',
        predicate: value => value instanceof hook_1.default && value.constructor && value.constructor !== hook_1.default
    },
    clientScriptInitializer: {
        name: 'client script initializer',
        predicate: value => typeof value === 'object' && ['path', 'content', 'module'].some(prop => value && prop in value)
    }
};
function assertType(types, callsiteName, what, value) {
    types = Array.isArray(types) ? types : [types];
    let pass = false;
    const actualType = typeof value;
    let actualMsg = actualType;
    let expectedTypeMsg = '';
    const last = types.length - 1;
    types.forEach((type, i) => {
        pass = pass || type.predicate(value, actualType);
        if (type.getActualValueMsg)
            actualMsg = type.getActualValueMsg(value, actualType);
        if (i === 0)
            expectedTypeMsg += type.name;
        else
            expectedTypeMsg += (i === last ? ' or ' + getIndefiniteArticle(type.name) + ' ' : ', ') + type.name;
    });
    if (!pass) {
        throw callsiteName ?
            new _1.APIError(callsiteName, types_1.RUNTIME_ERRORS.invalidValueType, what, expectedTypeMsg, actualMsg) :
            new _1.GeneralError(types_1.RUNTIME_ERRORS.invalidValueType, what, expectedTypeMsg, actualMsg);
    }
}
exports.assertType = assertType;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHlwZS1hc3NlcnRpb25zLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2Vycm9ycy9ydW50aW1lL3R5cGUtYXNzZXJ0aW9ucy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxtQ0FBMEY7QUFDMUYseUJBQTRDO0FBQzVDLG9DQUEwQztBQUMxQyx3RUFBdUQ7QUFFdkQsTUFBTSxtQkFBbUIsR0FBRyxXQUFXLENBQUM7QUFFeEMsU0FBUyxvQkFBb0IsQ0FBRSxJQUFJO0lBQy9CLE9BQU8sbUJBQW1CLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQztBQUN2RCxDQUFDO0FBRUQsU0FBUyxrQkFBa0IsQ0FBRSxLQUFLO0lBQzlCLE9BQU8saUJBQWMsQ0FBQyxLQUFLLENBQUMsSUFBSSxLQUFLLElBQUksQ0FBQyxDQUFDO0FBQy9DLENBQUM7QUFFRCxTQUFTLDJCQUEyQixDQUFFLEtBQUssRUFBRSxJQUFJO0lBQzdDLElBQUksSUFBSSxLQUFLLFFBQVE7UUFDakIsT0FBTyxJQUFJLENBQUM7SUFFaEIsSUFBSSxNQUFNLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQztRQUNuQixPQUFPLEdBQUcsQ0FBQztJQUVmLElBQUksQ0FBQyxpQkFBYyxDQUFDLEtBQUssQ0FBQztRQUN0QixPQUFPLFFBQVEsQ0FBQztJQUVwQixPQUFPLEtBQUssQ0FBQztBQUNqQixDQUFDO0FBRVksUUFBQSxFQUFFLEdBQUc7SUFDZCxNQUFNLEVBQUU7UUFDSixJQUFJLEVBQWUsUUFBUTtRQUMzQixTQUFTLEVBQVUsaUJBQWM7UUFDakMsaUJBQWlCLEVBQUUsMkJBQTJCO0tBQ2pEO0lBRUQsaUJBQWlCLEVBQUU7UUFDZixJQUFJLEVBQWUscUJBQXFCO1FBQ3hDLFNBQVMsRUFBVSxrQkFBa0I7UUFDckMsaUJBQWlCLEVBQUUsMkJBQTJCO0tBQ2pEO0lBRUQsdUJBQXVC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TyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsRUFBRSxFQUFFO1FBQ3RCLElBQUksR0FBRyxJQUFJLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLEVBQUUsVUFBVSxDQUFDLENBQUM7UUFFakQsSUFBSSxJQUFJLENBQUMsaUJBQWlCO1lBQ3RCLFNBQVMsR0FBRyxJQUFJLENBQUMsaUJBQWlCLENBQUMsS0FBSyxFQUFFLFVBQVUsQ0FBQyxDQUFDO1FBRTFELElBQUksQ0FBQyxLQUFLLENBQUM7WUFDUCxlQUFlLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQzs7WUFFN0IsZUFBZSxJQUFJLENBQUMsQ0FBQyxLQUFLLElBQUksQ0FBQyxDQUFDLENBQUMsTUFBTSxHQUFHLG9CQUFvQixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUM7SUFDNUcsQ0FBQyxDQUFDLENBQUM7SUFFSCxJQUFJLENBQUMsSUFBSSxFQUFFO1FBQ1AsTUFBTSxZQUFZLENBQUMsQ0FBQztZQUNoQixJQUFJLFdBQVEsQ0FBQyxZQUFZLEVBQUUsc0JBQWMsQ0FBQyxnQkFBZ0IsRUFBRSxJQUFJLEVBQUUsZUFBZSxFQUFFLFNBQVMsQ0FBQyxDQUFDLENBQUM7WUFDL0YsSUFBSSxlQUFZLENBQUMsc0JBQWMsQ0FBQyxnQkFBZ0IsRUFBRSxJQUFJLEVBQUUsZUFBZSxFQUFFLFNBQVMsQ0FBQyxDQUFDO0tBQzNGO0FBQ0wsQ0FBQztBQTFCRCxnQ0EwQkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpc0Zpbml0ZSBhcyBpc0Zpbml0ZU51bWJlciwgaXNSZWdFeHAsIGlzTmlsIGFzIGlzTnVsbE9yVW5kZWZpbmVkIH0gZnJvbSAnbG9kYXNoJztcbmltcG9ydCB7IEFQSUVycm9yLCBHZW5lcmFsRXJyb3IgfSBmcm9tICcuLyc7XG5pbXBvcnQgeyBSVU5USU1FX0VSUk9SUyB9IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCBSZXF1ZXN0SG9vayBmcm9tICcuLi8uLi9hcGkvcmVxdWVzdC1ob29rcy9ob29rJztcblxuY29uc3QgU1RBUlRfRlJPTV9WT1dFTF9SRSA9IC9eW2FlaW91XS9pO1xuXG5mdW5jdGlvbiBnZXRJbmRlZmluaXRlQXJ0aWNsZSAodGV4dCkge1xuICAgIHJldHVybiBTVEFSVF9GUk9NX1ZPV0VMX1JFLnRlc3QodGV4dCkgPyAnYW4nIDogJ2EnO1xufVxuXG5mdW5jdGlvbiBpc05vbk5lZ2F0aXZlVmFsdWUgKHZhbHVlKSB7XG4gICAgcmV0dXJuIGlzRmluaXRlTnVtYmVyKHZhbHVlKSAmJiB2YWx1ZSA+PSAwO1xufVxuXG5mdW5jdGlvbiBnZXROdW1iZXJUeXBlQWN0dWFsVmFsdWVNc2cgKHZhbHVlLCB0eXBlKSB7XG4gICAgaWYgKHR5cGUgIT09ICdudW1iZXInKVxuICAgICAgICByZXR1cm4gdHlwZTtcblxuICAgIGlmIChOdW1iZXIuaXNOYU4odmFsdWUpKVxuICAgICAgICByZXR1cm4gTmFOO1xuXG4gICAgaWYgKCFpc0Zpbml0ZU51bWJlcih2YWx1ZSkpXG4gICAgICAgIHJldHVybiBJbmZpbml0eTtcblxuICAgIHJldHVybiB2YWx1ZTtcbn1cblxuZXhwb3J0IGNvbnN0IGlzID0ge1xuICAgIG51bWJlcjoge1xuICAgICAgICBuYW1lOiAgICAgICAgICAgICAgJ251bWJlcicsXG4gICAgICAgIHByZWRpY2F0ZTogICAgICAgICBpc0Zpbml0ZU51bWJlcixcbiAgICAgICAgZ2V0QWN0dWFsVmFsdWVNc2c6IGdldE51bWJlclR5cGVBY3R1YWxWYWx1ZU1zZ1xuICAgIH0sXG5cbiAgICBub25OZWdhdGl2ZU51bWJlcjoge1xuICAgICAgICBuYW1lOiAgICAgICAgICAgICAgJ25vbi1uZWdhdGl2ZSBudW1iZXInLFxuICAgICAgICBwcmVkaWNhdGU6ICAgICAgICAgaXNOb25OZWdhdGl2ZVZhbHVlLFxuICAgICAgICBnZXRBY3R1YWxWYWx1ZU1zZzogZ2V0TnVtYmVyVHlwZUFjdHVhbFZhbHVlTXNnXG4gICAgfSxcblxuICAgIG5vbk5lZ2F0aXZlTnVtYmVyU3RyaW5nOiB7XG4gICAgICAgIG5hbWU6ICAgICAgJ25vbi1uZWdhdGl2ZSBudW1iZXInLFxuICAgICAgICBwcmVkaWNhdGU6IHZhbHVlID0+IGlzTm9uTmVnYXRpdmVWYWx1ZShwYXJzZUludCh2YWx1ZSwgMTApKSxcblxuICAgICAgICBnZXRBY3R1YWxWYWx1ZU1zZzogdmFsdWUgPT4ge1xuICAgICAgICAgICAgY29uc3QgbnVtYmVyID0gcGFyc2VJbnQodmFsdWUsIDEwKTtcblxuICAgICAgICAgICAgcmV0dXJuIGlzTmFOKG51bWJlcikgPyBKU09OLnN0cmluZ2lmeSh2YWx1ZSkgOiBudW1iZXI7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgYm9vbGVhbjoge1xuICAgICAgICBuYW1lOiAgICAgICdib29sZWFuJyxcbiAgICAgICAgcHJlZGljYXRlOiAodmFsdWUsIHR5cGUpID0+IHR5cGUgPT09ICdib29sZWFuJ1xuICAgIH0sXG5cbiAgICBzdHJpbmc6IHtcbiAgICAgICAgbmFtZTogICAgICAnc3RyaW5nJyxcbiAgICAgICAgcHJlZGljYXRlOiAodmFsdWUsIHR5cGUpID0+IHR5cGUgPT09ICdzdHJpbmcnXG4gICAgfSxcblxuICAgIGZ1bmN0aW9uOiB7XG4gICAgICAgIG5hbWU6ICAgICAgJ2Z1bmN0aW9uJyxcbiAgICAgICAgcHJlZGljYXRlOiAodmFsdWUsIHR5cGUpID0+IHR5cGUgPT09ICdmdW5jdGlvbidcbiAgICB9LFxuXG4gICAgcmVnRXhwOiB7XG4gICAgICAgIG5hbWU6ICAgICAgJ3JlZ3VsYXIgZXhwcmVzc2lvbicsXG4gICAgICAgIHByZWRpY2F0ZTogaXNSZWdFeHBcbiAgICB9LFxuXG4gICAgYXJyYXk6IHtcbiAgICAgICAgbmFtZTogICAgICAnYXJyYXknLFxuICAgICAgICBwcmVkaWNhdGU6IHZhbHVlID0+IEFycmF5LmlzQXJyYXkodmFsdWUpXG4gICAgfSxcblxuICAgIG5vbk51bGxPYmplY3Q6IHtcbiAgICAgICAgbmFtZTogICAgICAgICAgICAgICdub24tbnVsbCBvYmplY3QnLFxuICAgICAgICBwcmVkaWNhdGU6ICAgICAgICAgKHZhbHVlLCB0eXBlKSA9PiB0eXBlID09PSAnb2JqZWN0JyAmJiAhaXNOdWxsT3JVbmRlZmluZWQodmFsdWUpLFxuICAgICAgICBnZXRBY3R1YWxWYWx1ZU1zZzogKHZhbHVlLCB0eXBlKSA9PiBpc051bGxPclVuZGVmaW5lZCh2YWx1ZSkgPyBTdHJpbmcodmFsdWUpIDogdHlwZVxuICAgIH0sXG5cbiAgICByZXF1ZXN0SG9va1N1YmNsYXNzOiB7XG4gICAgICAgIG5hbWU6ICAgICAgJ1JlcXVlc3RIb29rIHN1YmNsYXNzJyxcbiAgICAgICAgcHJlZGljYXRlOiB2YWx1ZSA9PiB2YWx1ZSBpbnN0YW5jZW9mIFJlcXVlc3RIb29rICYmIHZhbHVlLmNvbnN0cnVjdG9yICYmIHZhbHVlLmNvbnN0cnVjdG9yICE9PSBSZXF1ZXN0SG9va1xuICAgIH0sXG5cbiAgICBjbGllbnRTY3JpcHRJbml0aWFsaXplcjoge1xuICAgICAgICBuYW1lOiAgICAgICdjbGllbnQgc2NyaXB0IGluaXRpYWxpemVyJyxcbiAgICAgICAgcHJlZGljYXRlOiB2YWx1ZSA9PiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIFsncGF0aCcsICdjb250ZW50JywgJ21vZHVsZSddLnNvbWUocHJvcCA9PiB2YWx1ZSAmJiBwcm9wIGluIHZhbHVlKVxuICAgIH1cbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBhc3NlcnRUeXBlICh0eXBlcywgY2FsbHNpdGVOYW1lLCB3aGF0LCB2YWx1ZSkge1xuICAgIHR5cGVzID0gQXJyYXkuaXNBcnJheSh0eXBlcykgPyB0eXBlcyA6IFt0eXBlc107XG5cbiAgICBsZXQgcGFzcyAgICAgICAgICAgID0gZmFsc2U7XG4gICAgY29uc3QgYWN0dWFsVHlwZSAgICAgID0gdHlwZW9mIHZhbHVlO1xuICAgIGxldCBhY3R1YWxNc2cgICAgICAgPSBhY3R1YWxUeXBlO1xuICAgIGxldCBleHBlY3RlZFR5cGVNc2cgPSAnJztcbiAgICBjb25zdCBsYXN0ICAgICAgICAgICAgPSB0eXBlcy5sZW5ndGggLSAxO1xuXG4gICAgdHlwZXMuZm9yRWFjaCgodHlwZSwgaSkgPT4ge1xuICAgICAgICBwYXNzID0gcGFzcyB8fCB0eXBlLnByZWRpY2F0ZSh2YWx1ZSwgYWN0dWFsVHlwZSk7XG5cbiAgICAgICAgaWYgKHR5cGUuZ2V0QWN0dWFsVmFsdWVNc2cpXG4gICAgICAgICAgICBhY3R1YWxNc2cgPSB0eXBlLmdldEFjdHVhbFZhbHVlTXNnKHZhbHVlLCBhY3R1YWxUeXBlKTtcblxuICAgICAgICBpZiAoaSA9PT0gMClcbiAgICAgICAgICAgIGV4cGVjdGVkVHlwZU1zZyArPSB0eXBlLm5hbWU7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGV4cGVjdGVkVHlwZU1zZyArPSAoaSA9PT0gbGFzdCA/ICcgb3IgJyArIGdldEluZGVmaW5pdGVBcnRpY2xlKHR5cGUubmFtZSkgKyAnICcgOiAnLCAnKSArIHR5cGUubmFtZTtcbiAgICB9KTtcblxuICAgIGlmICghcGFzcykge1xuICAgICAgICB0aHJvdyBjYWxsc2l0ZU5hbWUgP1xuICAgICAgICAgICAgbmV3IEFQSUVycm9yKGNhbGxzaXRlTmFtZSwgUlVOVElNRV9FUlJPUlMuaW52YWxpZFZhbHVlVHlwZSwgd2hhdCwgZXhwZWN0ZWRUeXBlTXNnLCBhY3R1YWxNc2cpIDpcbiAgICAgICAgICAgIG5ldyBHZW5lcmFsRXJyb3IoUlVOVElNRV9FUlJPUlMuaW52YWxpZFZhbHVlVHlwZSwgd2hhdCwgZXhwZWN0ZWRUeXBlTXNnLCBhY3R1YWxNc2cpO1xuICAgIH1cbn1cbiJdfQ==