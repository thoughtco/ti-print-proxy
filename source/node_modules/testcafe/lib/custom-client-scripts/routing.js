"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.unRegister = exports.register = exports.isLegacyTest = void 0;
const get_url_1 = __importDefault(require("./get-url"));
const get_code_1 = __importDefault(require("./get-code"));
const content_types_1 = __importDefault(require("../assets/content-types"));
function isLegacyTest(test) {
    return !!test.isLegacy;
}
exports.isLegacyTest = isLegacyTest;
function register(proxy, tests) {
    const routes = [];
    tests.forEach(test => {
        if (isLegacyTest(test))
            return;
        test.clientScripts.forEach((script) => {
            const route = get_url_1.default(script);
            proxy.GET(route, {
                content: get_code_1.default(script),
                contentType: content_types_1.default.javascript
            });
            routes.push(route);
        });
    });
    return routes;
}
exports.register = register;
function unRegister(proxy, routes) {
    routes.forEach(route => {
        proxy.unRegisterRoute(route, 'GET');
    });
}
exports.unRegister = unRegister;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicm91dGluZy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jdXN0b20tY2xpZW50LXNjcmlwdHMvcm91dGluZy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSx3REFBaUQ7QUFDakQsMERBQW1EO0FBQ25ELDRFQUFvRDtBQWVwRCxTQUFnQixZQUFZLENBQUUsSUFBYztJQUN4QyxPQUFPLENBQUMsQ0FBRSxJQUFtQixDQUFDLFFBQVEsQ0FBQztBQUMzQyxDQUFDO0FBRkQsb0NBRUM7QUFFRCxTQUFnQixRQUFRLENBQUUsS0FBWSxFQUFFLEtBQWlCO0lBQ3JELE1BQU0sTUFBTSxHQUFhLEVBQUUsQ0FBQztJQUU1QixLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFO1FBQ2pCLElBQUksWUFBWSxDQUFDLElBQUksQ0FBQztZQUNsQixPQUFPO1FBRVgsSUFBSSxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxNQUFvQixFQUFFLEVBQUU7WUFDaEQsTUFBTSxLQUFLLEdBQUcsaUJBQXdCLENBQUMsTUFBTSxDQUFDLENBQUM7WUFFL0MsS0FBSyxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUU7Z0JBQ2IsT0FBTyxFQUFNLGtCQUF5QixDQUFDLE1BQU0sQ0FBQztnQkFDOUMsV0FBVyxFQUFFLHVCQUFhLENBQUMsVUFBVTthQUN4QyxDQUFDLENBQUM7WUFFSCxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3ZCLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQyxDQUFDLENBQUM7SUFFSCxPQUFPLE1BQU0sQ0FBQztBQUNsQixDQUFDO0FBcEJELDRCQW9CQztBQUVELFNBQWdCLFVBQVUsQ0FBRSxLQUFZLEVBQUUsTUFBZ0I7SUFDdEQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBRTtRQUNuQixLQUFLLENBQUMsZUFBZSxDQUFDLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQztJQUN4QyxDQUFDLENBQUMsQ0FBQztBQUNQLENBQUM7QUFKRCxnQ0FJQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBnZXRDdXN0b21DbGllbnRTY3JpcHRVcmwgZnJvbSAnLi9nZXQtdXJsJztcbmltcG9ydCBnZXRDdXN0b21DbGllbnRTY3JpcHRDb2RlIGZyb20gJy4vZ2V0LWNvZGUnO1xuaW1wb3J0IENPTlRFTlRfVFlQRVMgZnJvbSAnLi4vYXNzZXRzL2NvbnRlbnQtdHlwZXMnO1xuaW1wb3J0IENsaWVudFNjcmlwdCBmcm9tICcuL2NsaWVudC1zY3JpcHQnO1xuaW1wb3J0IHsgUHJveHkgfSBmcm9tICd0ZXN0Y2FmZS1oYW1tZXJoZWFkJztcblxuXG5pbnRlcmZhY2UgVGVzdCB7XG4gICAgY2xpZW50U2NyaXB0czogQ2xpZW50U2NyaXB0W107XG59XG5cbmludGVyZmFjZSBMZWdhY3lUZXN0IHtcbiAgICBpc0xlZ2FjeTogYm9vbGVhbjtcbn1cblxudHlwZSBUZXN0SXRlbSA9IFRlc3QgfCBMZWdhY3lUZXN0O1xuXG5leHBvcnQgZnVuY3Rpb24gaXNMZWdhY3lUZXN0ICh0ZXN0OiBUZXN0SXRlbSk6IHRlc3QgaXMgTGVnYWN5VGVzdCB7XG4gICAgcmV0dXJuICEhKHRlc3QgYXMgTGVnYWN5VGVzdCkuaXNMZWdhY3k7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZWdpc3RlciAocHJveHk6IFByb3h5LCB0ZXN0czogVGVzdEl0ZW1bXSk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCByb3V0ZXM6IHN0cmluZ1tdID0gW107XG5cbiAgICB0ZXN0cy5mb3JFYWNoKHRlc3QgPT4ge1xuICAgICAgICBpZiAoaXNMZWdhY3lUZXN0KHRlc3QpKVxuICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgIHRlc3QuY2xpZW50U2NyaXB0cy5mb3JFYWNoKChzY3JpcHQ6IENsaWVudFNjcmlwdCkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgcm91dGUgPSBnZXRDdXN0b21DbGllbnRTY3JpcHRVcmwoc2NyaXB0KTtcblxuICAgICAgICAgICAgcHJveHkuR0VUKHJvdXRlLCB7XG4gICAgICAgICAgICAgICAgY29udGVudDogICAgIGdldEN1c3RvbUNsaWVudFNjcmlwdENvZGUoc2NyaXB0KSxcbiAgICAgICAgICAgICAgICBjb250ZW50VHlwZTogQ09OVEVOVF9UWVBFUy5qYXZhc2NyaXB0XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcm91dGVzLnB1c2gocm91dGUpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIHJldHVybiByb3V0ZXM7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1blJlZ2lzdGVyIChwcm94eTogUHJveHksIHJvdXRlczogc3RyaW5nW10pOiB2b2lkIHtcbiAgICByb3V0ZXMuZm9yRWFjaChyb3V0ZSA9PiB7XG4gICAgICAgIHByb3h5LnVuUmVnaXN0ZXJSb3V0ZShyb3V0ZSwgJ0dFVCcpO1xuICAgIH0pO1xufVxuIl19