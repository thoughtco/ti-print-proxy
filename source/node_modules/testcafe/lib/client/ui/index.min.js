!function Pe(ke){var Re=ke.document;!function(s,o,t){var e="default"in s?s.default:s,i="default"in o?o.default:o;t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t;var r={uiRoot:null,element:function(){return this.uiRoot||(this.uiRoot=Re.createElement("div"),s.shadowUI.getRoot().appendChild(this.uiRoot)),this.uiRoot},hide:function(){this.uiRoot&&(this.uiRoot.style.visibility="hidden")},show:function(){this.uiRoot&&(this.uiRoot.style.visibility="")},remove:function(){var t=s.shadowUI.getRoot();s.nativeMethods.nodeParentNodeGetter.call(t).removeChild(t)}},c=e.shadowUI,u=e.utils.browser,a=e.utils.featureDetection,d=e.nativeMethods,h=e.eventSandbox.eventSimulator,l=e.eventSandbox.listeners,p=i.positionUtils,m=i.domUtils,g=i.styleUtils,f=i.eventUtils,v=i.arrayUtils,y="tcOptionList",C="tcOptionGroup",E="tcOption",_="disabled",w=u.isIE?30:20,S=null,I=null,b=[],x=[];function T(t){(t.target||t.srcElement)===S||m.containsElement(S,t.target)||m.containsElement(I,t.target)||D()}function B(t,e,i){var n,s=v.indexOf(x,t.target);s<0||(i(),(n=-1<t.target.className.indexOf(_))&&u.isWebKit||function(t,e){var i=S.selectedIndex,n=S.getElementsByTagName("option")[t],s=!e&&t!==i;s&&!u.isIE&&(S.selectedIndex=t),u.isFirefox||u.isIE||!s||(h.input(S),h.change(S)),(u.isFirefox||u.isIE)&&h.mousedown(u.isFirefox?n:S),a.isTouchDevice||h.mouseup(u.isFirefox?n:S),(u.isFirefox||u.isIE)&&s&&(u.isIE&&(S.selectedIndex=t),u.isIE||h.input(S),h.change(S)),a.isTouchDevice||h.click(u.isFirefox||u.isIE?n:S),e||D()}(s,n))}function U(t,e){for(var i,n,s,o,a,r,l,u=m.getChildrenLength(t),h=0;h<u;h++)m.isOptionElement(t[h])?(o=t[h],a=e,l=r=void 0,r=Re.createElement("div"),l=o.disabled||"optgroup"===m.getTagName(o.parentElement)&&o.parentElement.disabled,d.nodeTextContentSetter.call(r,o.text),a.appendChild(r),c.addClass(r,E),l&&(c.addClass(r,_),g.set(r,"color",g.get(o,"color"))),x.push(r)):"optgroup"===m.getTagName(t[h])&&(i=t[h],n=e,s=void 0,s=Re.createElement("div"),d.nodeTextContentSetter.call(s,i.label||" "),n.appendChild(s),c.addClass(s,C),s.disabled&&(c.addClass(s,_),g.set(s,"color",g.get(i,"color"))),U(i.children,s),b.push(s))}function D(){m.remove(I),f.unbind(Re,"mousedown",T),S=I=null,x=[],b=[]}function M(t){return t?t===S:!!S}var n=Object.freeze({__proto__:null,expandOptionList:function(t){var e=t.children;if(e.length){if(S){var i=t===S;if(D(),i)return}S=t,I=Re.createElement("div"),r.element().appendChild(I),c.addClass(I,y),U(e,I),l.addInternalEventListener(ke,["click"],B),d.setTimeout.call(ke,function(){f.bind(Re,"mousedown",T)},0),g.set(I,{position:"absolute",fontSize:g.get(S,"fontSize"),fontFamily:g.get(S,"fontFamily"),minWidth:g.getWidth(S)+"px",left:p.getOffsetPosition(S).left+"px",height:m.getSelectVisibleChildren(t).length>w?g.getOptionHeight(t)*w:""});var n,s=p.getOffsetPosition(S).top,o=g.getHeight(I),a=s+g.getHeight(S)+2;a+o>g.getScrollTop(ke)+g.getHeight(ke)&&(n=s-3-o)>=g.getScrollTop(ke)&&(a=n),g.set(I,"top",a+"px")}},collapseOptionList:D,isOptionListExpanded:M,getEmulatedChildElement:function(t){var e="optgroup"===m.getTagName(t),i=m.getElementIndexInParent(S,t);return e?b[i]:x[i]},scrollOptionListByChild:function(t){var e,i,n,s,o,a,r=m.getSelectParent(t);r&&(e=g.getSelectElementSize(r),i=g.getOptionHeight(r),n=0,o=(s=Math.max(g.getScrollTop(r)/i,0))+e-1,(a=m.getChildVisibleIndex(r,t))<s?(n=i*(s-a),g.setScrollTop(r,Math.max(g.getScrollTop(r)-n,0))):o<a&&(n=i*(a-o),g.setScrollTop(r,g.getScrollTop(r)+n)))},getSelectChildCenter:function(t){var e=m.getSelectParent(t);if(!e)return{x:0,y:0};var i=g.getOptionHeight(e),n=p.getElementRectangle(t);return{x:Math.round(n.left+n.width/2),y:Math.round(n.top+i/2)}},switchOptionsByKeys:function(t,e){var i=g.getSelectElementSize(t),n=!g.hasDimensions(c.select("."+y)[0]);if(/down|up/.test(e)||!u.isIE&&(i<=1||u.isFirefox)&&(n||u.isFirefox)&&/left|right/.test(e)){for(var s=t.querySelectorAll("option"),o=[],a=0;a<s.length;a++){var r=s[a].parentElement;s[a].disabled||"optgroup"===m.getTagName(r)&&r.disabled||o.push(s[a])}var l=v.indexOf(o,s[t.selectedIndex])+(/down|right/.test(e)?1:-1);0<=l&&l<o.length&&(t.selectedIndex=v.indexOf(s,o[l]),u.isIE||h.input(t),h.change(t))}},isOptionElementVisible:function(t){var e=m.getSelectParent(t);if(!e)return!0;var i=M(e),n=g.getSelectElementSize(e);return i||1<n}}),A="Loading page...",V="modal-background",P="loading-text",k="loading-icon",R=null,W=null,O=null,F=!1;function L(){function t(){var t=o.styleUtils.getHeight(ke),e=o.styleUtils.getWidth(ke);o.styleUtils.set(R,"width",e+"px"),o.styleUtils.set(R,"height",t+"px"),o.styleUtils.set(O,{left:Math.round((e-o.styleUtils.getWidth(O))/2)+"px",top:Math.round((t-o.styleUtils.getHeight(O))/2)+"px"})}t(),o.eventUtils.bind(ke,"resize",t)}function H(){var t,e,i,n;t=r.element(),R=Re.createElement("div"),t.appendChild(R),s.shadowUI.addClass(R,V),W=Re.createElement("div"),s.nativeMethods.nodeTextContentSetter.call(W,A),t.appendChild(W),s.shadowUI.addClass(W,P),O=Re.createElement("div"),o.styleUtils.set(O,"visibility","hidden"),t.appendChild(O),s.shadowUI.addClass(O,k),L(),e=o.styleUtils.getHeight(ke),i=o.styleUtils.getWidth(ke),(n=!o.styleUtils.hasDimensions(W))&&(o.styleUtils.set(W,"visibility","hidden"),o.styleUtils.set(W,"display","block")),o.styleUtils.set(W,{left:Math.max((i-o.styleUtils.getWidth(W))/2,0)+"px",top:Math.max((e-o.styleUtils.getHeight(W))/2,0)+"px"}),n&&(o.styleUtils.set(W,"display","none"),o.styleUtils.set(W,"visibility","")),F=!0}var N=Object.freeze({__proto__:null,initAndShowLoadingText:function(){function t(){H(),o.styleUtils.set(R,"opacity",.8),o.styleUtils.set(R,"display","block"),o.styleUtils.set(W,"display","block"),e=!0}var e=!1,i=function(){e||(Re.body?t():s.nativeMethods.setTimeout.call(ke,i,0))};i(),o.eventUtils.documentReady().then(function(){e||t()})},show:function(t){F||H(),o.styleUtils.set(R,"opacity",t?0:.7),o.styleUtils.set(R,"display","block")},hide:function(){F&&(o.styleUtils.set(W,"display","none"),o.styleUtils.set(R,"display","none"))},showLoadingIcon:function(){o.styleUtils.set(O,"visibility","visible")},hideLoadingIcon:function(){o.styleUtils.set(O,"visibility","hidden")}}),q=e.shadowUI,z=i.styleUtils,G="success",j=(K.prototype.setValue=function(t){t="number"!=typeof t?0:Math.min(Math.max(t,0),100),z.set(this.valueElement,"width",t+"%")},K.prototype.setSuccess=function(t){t?q.addClass(this.containerElement,G):q.removeClass(this.containerElement,G)},K);function K(t){this.containerElement=Re.createElement("div"),this.valueElement=Re.createElement("div"),t.appendChild(this.containerElement),this.containerElement.appendChild(this.valueElement),q.addClass(this.containerElement,"progress-bar"),q.addClass(this.valueElement,"value")}var Y=e.shadowUI,X=e.nativeMethods,J=i.eventUtils,Q=i.styleUtils,Z="progress-panel",$="title",tt="content",et=(it._getInvisibleElementProperty=function(t,e){var i="none"===Q.get(t,"display");i&&Q.set(t,"display","block");var n=t[e];return i&&Q.set(t,"display","none"),n},it._showAtWindowCenter=function(t){var e=it._getInvisibleElementProperty(t,"offsetHeight"),i=it._getInvisibleElementProperty(t,"offsetWidth"),n=Math.round(Q.getHeight(ke)/2-e/2),s=Math.round(Q.getWidth(ke)/2-i/2);Q.set(t,{left:s+"px",top:n+"px"})},it.prototype._setCurrentProgress=function(){var t=Math.round((Date.now()-this.startTime)/this.maxTimeout*100);this.progressBar.setValue(t)},it.prototype._setSuccess=function(t){this.progressBar.setSuccess(t)},it.prototype._stopAnimation=function(){X.clearInterval.call(ke,this.animationInterval)},it.prototype._animate=function(t,e,i,n){var s,o,a,r=this,l=Date.now(),u=i?0:1;i&&(Q.set(t,"opacity",u),Q.set(t,"display","block")),this._stopAnimation(),this.animationInterval=X.setInterval.call(ke,function(){s=Date.now()-l,o=Math.min(s/e,1),a=.5-Math.cos(o*Math.PI)/2,Q.set(t,"opacity",u+(i?a:-a)),1===o&&(r._stopAnimation(),n&&n())},10)},it.prototype._showPanel=function(){J.bind(ke,"resize",this.disposePanel),this._animate(this.panelDiv,200,!0)},it.prototype._hidePanel=function(t){var e=this;this.startTime=null,J.unbind(ke,"resize",this.disposePanel),this._animate(this.panelDiv,t?0:600,!1,function(){return Q.set(e.panelDiv,"display","none")})},it.prototype.show=function(t,e){var i=this;this.startTime=Date.now(),this.maxTimeout=e,X.nodeTextContentSetter.call(this.titleDiv,t),this._setSuccess(!1),this.openingTimeout=X.setTimeout.call(ke,function(){i.openingTimeout=null,i._setCurrentProgress(),i._showPanel(),i.updateInterval=X.setInterval.call(ke,function(){return i._setCurrentProgress()},100)},300)},it.prototype.close=function(t){var e=this;t&&this._setSuccess(!0),this.openingTimeout&&(X.clearTimeout.call(ke,this.openingTimeout),this.openingTimeout=null),this.updateInterval&&(X.clearInterval.call(ke,this.updateInterval),this.updateInterval=null),t?this.startTime&&Date.now()-this.startTime<1e3?X.setTimeout.call(ke,function(){X.setTimeout.call(ke,function(){return e._hidePanel(!1)},200)},100):X.setTimeout.call(ke,function(){return e._hidePanel(!1)},200):this._hidePanel(!0)},it);function it(){var t=this;this.startTime=null,this.openingTimeout=null,this.updateInterval=null,this.animationInterval=null,this.panelDiv=Re.createElement("div"),r.element().appendChild(this.panelDiv),this.titleDiv=Re.createElement("div"),this.panelDiv.appendChild(this.titleDiv),this.contentDiv=Re.createElement("div"),this.panelDiv.appendChild(this.contentDiv),Y.addClass(this.panelDiv,Z),Y.addClass(this.titleDiv,$),Y.addClass(this.contentDiv,tt),it._showAtWindowCenter(this.panelDiv),this.progressBar=new j(this.contentDiv),this.disposePanel=function(){return it._showAtWindowCenter(t.panelDiv)}}var nt=function(t,e){return(nt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function st(t,e){function i(){this.constructor=t}nt(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var ot=e.shadowUI,at=e.nativeMethods,rt=i.styleUtils,lt="determinate",ut=(ht.prototype._setCurrentProgress=function(){var t=(Date.now()-this.startTime)/this.maxTimeout,e=Math.min(Math.max(t,0),1),i=rt.getWidth(this.progressBar),n=Math.round(i*e);rt.set(this.firstValueElement,"width",n+"px")},ht.prototype.start=function(t,e){var i=this;ot.addClass(this.progressBar,lt),this.maxTimeout=t,this.startTime=e||Date.now(),this._setCurrentProgress(),this.animationInterval=at.setInterval.call(ke,function(){return i._setCurrentProgress()},10)},ht.prototype.stop=function(){this.animationInterval&&(at.clearInterval.call(ke,this.animationInterval),this.animationInterval=null)},ht.prototype.reset=function(){rt.set(this.firstValueElement,"width",0),ot.removeClass(this.progressBar,lt)},ht);function ht(t,e){this.progressBar=t,this.firstValueElement=e,this.maxTimeout=null,this.startTime=null,this.animationInterval=null}var ct=e.shadowUI,dt=e.nativeMethods,pt=i.styleUtils,mt=i.positionUtils,gt={time:2800,points:[.815,.395],positionByCompletePercent:{0:{left:-35,right:100},.6:{left:100,right:-90},1:{left:100,right:-90}}},ft={time:3e3,points:[.84,1],positionByCompletePercent:{0:{left:-200,right:100},.6:{left:107,right:-8},1:{left:107,right:-8}}},vt=0,yt=.6,Ct=1,Et="indeterminate",_t=(wt._updateValueAnimation=function(t,e,i){var n,s,o,a,r,l,u,h,c,d,p,m,g,f=i.time,v=i.points,y=i.positionByCompletePercent,C=Date.now()-t,E=(n=C/f,s=v[0],o=v[1],3*Math.pow(1-n,2)*n*s+3*(1-n)*n*n*o+n*n*n),_=(h=(l=(a=E)<yt)?yt:Ct,c=(r=y)[u=l?vt:yt],d=r[h],p={x:u,y:c.left},m={x:h,y:d.left},g=mt.getLineYByXCoord(p,m,a),p={x:u,y:c.right},m={x:h,y:d.right},{left:g,right:mt.getLineYByXCoord(p,m,a)}),w=_.left,S=_.right;pt.set(e,"left",Math.round(w)+"%"),pt.set(e,"right",Math.round(S)+"%")},wt.prototype._clearFirstValueAnimation=function(){this.animationInterval&&(dt.clearInterval.call(ke,this.animationInterval),this.animationInterval=null),pt.set(this.firstValue,"left","-35%"),pt.set(this.firstValue,"right","100%")},wt.prototype._clearSecondValueAnimation=function(){this.secondValueAnimationInterval&&(dt.clearInterval.call(ke,this.secondValueAnimationInterval),this.secondValueAnimationInterval=null),pt.set(this.secondValue,"left","-200%"),pt.set(this.secondValue,"right","100%")},wt.prototype._startFirstValueAnimation=function(){var t=this;this._clearFirstValueAnimation();var e=Date.now();this.animationInterval=dt.setInterval.call(ke,function(){wt._updateValueAnimation(e,t.firstValue,gt)},10)},wt.prototype._startSecondValueAnimation=function(){var t=this;this._clearSecondValueAnimation();var e=Date.now();this.secondValueAnimationInterval=dt.setInterval.call(ke,function(){wt._updateValueAnimation(e,t.secondValue,ft)},10)},wt.prototype._startAnimation=function(){var t=this;this._startFirstValueAnimation(),this.secondValueAnimationTimeout=dt.setTimeout.call(ke,function(){return t._startSecondValueAnimation()},1e3),this.restartAnimationTimeout=dt.setTimeout.call(ke,function(){return t._startAnimation()},1950)},wt.prototype._stopAnimation=function(){this._clearFirstValueAnimation(),this._clearSecondValueAnimation(),this.secondValueAnimationTimeout&&(dt.clearInterval.call(ke,this.secondValueAnimationTimeout),this.secondValueAnimationTimeout=null),this.restartAnimationTimeout&&(dt.clearInterval.call(ke,this.restartAnimationTimeout),this.restartAnimationTimeout=null)},wt.prototype.start=function(){ct.addClass(this.progressBar,Et),this._startAnimation()},wt.prototype.stop=function(){ct.removeClass(this.progressBar,Et),this._stopAnimation()},wt);function wt(t,e,i){this.progressBar=t,this.firstValue=e,this.secondValue=i,this.animationInterval=null,this.secondValueAnimationInterval=null,this.secondValueAnimationTimeout=null,this.restartAnimationTimeout=null}var St=e.shadowUI,It=i.styleUtils,bt=(xt.prototype._create=function(t){this.progressBar=Re.createElement("div"),St.addClass(this.progressBar,"progress-bar"),t.appendChild(this.progressBar);var e=Re.createElement("div");St.addClass(e,"value-container"),this.progressBar.appendChild(e),this.firstValueElement=Re.createElement("div"),St.addClass(this.firstValueElement,"value"),e.appendChild(this.firstValueElement),this.secondValueElement=Re.createElement("div"),St.addClass(this.secondValueElement,"value"),e.appendChild(this.secondValueElement)},xt.prototype.show=function(){It.set(this.progressBar,"visibility","visible")},xt.prototype.hide=function(){It.set(this.progressBar,"visibility","hidden")},xt);function xt(t){this.progressBar=null,this.firstValueElement=null,this.secondValueElement=null,this._create(t),this.determinateIndicator=new ut(this.progressBar,this.firstValueElement),this.indeterminateIndicator=new _t(this.progressBar,this.firstValueElement,this.secondValueElement)}var Tt,Bt="start-waiting-element",Ut="end-waiting-element-request",Dt="end-waiting-element-response",Mt="start-waiting-assertion-retries",At="end-waiting-assertion-retries-request",Vt="end-waiting-assertion-retries-response",Pt=e.Promise,kt=e.shadowUI,Rt=e.nativeMethods,Wt=e.eventSandbox.message,Ot=e.utils.browser,Ft=e.utils.featureDetection,Lt=e.eventSandbox.listeners,Ht=i.styleUtils,Nt=i.eventUtils,qt=i.domUtils,zt=i.serviceUtils,Gt=i.arrayUtils,jt="waiting-element-failed",Kt="waiting-element-success",Yt="%testCafeStatusPrefix%",Xt=(st(Jt,Tt=zt.EventEmitter),Jt.prototype._createButton=function(t,e){var i=Re.createElement("div"),n=Re.createElement("div"),s=Re.createElement("span");return Rt.nodeTextContentSetter.call(s,t),kt.addClass(i,"button"),kt.addClass(i,e),kt.addClass(n,"button-icon"),Ot.isSafari&&(s.style.position="relative",s.style.top="1px"),i.appendChild(n),i.appendChild(s),i},Jt.prototype._createIconArea=function(){this.icon=Re.createElement("div"),kt.addClass(this.icon,"icon"),this.statusBar.appendChild(this.icon)},Jt.prototype._createInformationArea=function(){this.infoContainer=Re.createElement("div"),kt.addClass(this.infoContainer,"info-container"),this.statusBar.appendChild(this.infoContainer);var t=Re.createElement("div");kt.addClass(t,"info-text-container"),this.infoContainer.appendChild(t);var e=Re.createElement("div");kt.addClass(e,"status-container"),t.appendChild(e),this.statusDiv=Re.createElement("div"),this.statusDiv=Re.createElement("div"),Rt.nodeTextContentSetter.call(this.statusDiv,this._getFullStatusText("Loading Web Page...")),kt.addClass(this.statusDiv,"status"),kt.addClass(this.statusDiv,"info"),e.appendChild(this.statusDiv);var i=Re.createElement("div");Rt.nodeTextContentSetter.call(i,this.fixtureName+" - "+this.testName),kt.addClass(i,"fixture"),kt.addClass(i,"info"),e.appendChild(i);var n=Re.createElement("div");Rt.nodeTextContentSetter.call(n,this.userAgent),kt.addClass(n,"user-agent"),t.appendChild(n)},Jt.prototype._createActionsArea=function(){var t=this;this.actionsContainer=Re.createElement("div"),kt.addClass(this.actionsContainer,"actions-container"),this.statusBar.appendChild(this.actionsContainer),this.buttons=Re.createElement("div"),kt.addClass(this.buttons,"buttons"),this.actionsContainer.appendChild(this.buttons),this.unlockButton=this._createButton("Unlock Page","locked"),this.resumeButton=this._createButton("Resume","resume"),this.nextButton=this._createButton("Next Action","step"),this.finishButton=this._createButton("Finish","finish"),this.buttons.appendChild(this.unlockButton),this.buttons.appendChild(this.resumeButton),this.buttons.appendChild(this.nextButton),this.actionsContainer.style.display="none",this._bindClickOnce([this.unlockButton],function(){kt.removeClass(t.unlockButton,"locked"),kt.addClass(t.unlockButton,"unlocked"),Rt.nodeTextContentSetter.call(t.unlockButton.querySelector("span"),"Page unlocked"),t.state.locked=!1,t.emit(t.UNLOCK_PAGE_BTN_CLICK,{})}),this.unlockButton.style.display="none"},Jt.prototype._create=function(){this.statusBar=Re.createElement("div"),kt.addClass(this.statusBar,"status-bar"),this._createIconArea(),this._createInformationArea(),this._createActionsArea(),this.progressBar=new bt(this.infoContainer),this.progressBar.indeterminateIndicator.start(),this.progressBar.show(),r.element().appendChild(this.statusBar),this._bindHandlers(),this.state.created=!0},Jt.prototype._createBeforeReady=function(){var t=this;this.state.created||ke!==ke.top||(Re.body?this._create():Rt.setTimeout.call(ke,function(){return t._createBeforeReady()},0))},Jt.prototype._animate=function(t){var e,i,n,s=this,o=Date.now(),a=parseInt(Ht.get(this.statusBar,"opacity"),10)||0;this._stopAnimation(),t&&(Ht.set(this.statusBar,"visibility",""),this.state.hidden=!1),this.animationInterval=Rt.setInterval.call(ke,function(){e=Date.now()-o,i=Math.min(e/500,1),n=.5-Math.cos(i*Math.PI)/2,Ht.set(s.statusBar,"opacity",a+(t?n:-n)),1===i&&(s._stopAnimation(),t||(Ht.set(s.statusBar,"visibility","hidden"),s.state.hidden=!0),s.state.showing=!1,s.state.hiding=!1)},10)},Jt.prototype._stopAnimation=function(){this.animationInterval&&(Rt.clearInterval.call(ke,this.animationInterval),this.animationInterval=null)},Jt.prototype._fadeOut=function(){this.state.hiding||this.state.debugging||(this.state.showing=!1,this.state.hiding=!0,this._animate())},Jt.prototype._fadeIn=function(){this.state.showing||this.state.debugging||(this.state.hiding=!1,this.state.showing=!0,this._animate(!0))},Jt.prototype._bindHandlers=function(){var e=this;Lt.initElementListening(ke,["resize"]),Lt.addInternalEventListener(ke,["resize"],function(){e.windowHeight=ke.innerHeight});var i=Ht.getHeight(this.statusBar);Lt.addFirstInternalHandler(ke,["mousemove","mouseout","touchmove"],function(t){"mouseout"!==t.type||t.relatedTarget?"mousemove"!==t.type&&"touchmove"!==t.type||(t.clientY>e.windowHeight-i?e._fadeOut(t):e.state.hidden&&e._fadeIn(t)):e._fadeIn(t)})},Jt.prototype._bindClickOnce=function(t,i){var n=this,s=Ft.isTouchDevice?"touchstart":"mousedown",o=function(e){Gt.find(t,function(t){return qt.containsElement(t,e.target)})?(Nt.preventDefault(e),Lt.removeInternalEventListener(ke,[s],o),i(e)):qt.containsElement(n.statusBar,e.target)&&Nt.preventDefault(e)};Lt.addInternalEventListener(ke,[s],o)},Jt.prototype._initChildListening=function(){var i=this;Wt.on(Wt.SERVICE_MSG_RECEIVED_EVENT,function(t){var e=t.message;e.cmd===Bt?i.showWaitingElementStatus(e.timeout):e.cmd===Ut?i.hideWaitingElementStatus(e.waitingSuccess).then(function(){return Wt.sendServiceMsg({cmd:Dt},t.source)}):e.cmd===Mt?i.showWaitingAssertionRetriesStatus(e.timeout):e.cmd===At&&i.hideWaitingAssertionRetriesStatus(e.waitingSuccess).then(function(){return Wt.sendServiceMsg({cmd:Vt},t.source)})})},Jt.prototype._resetState=function(){this.state.debugging=!1,this.actionsContainer.style.display="none",this.unlockButton.style.display="none",Rt.nodeTextContentSetter.call(this.statusDiv,this._getFullStatusText("")),this.progressBar.hide()},Jt.prototype._getFullStatusText=function(t){var e=this.contextStorage.getItem(Yt)||"";return e+(e&&t?". ":"")+t},Jt.prototype._showWaitingStatus=function(){var t=this.state.assertionRetries?"Waiting for assertion execution...":"Waiting for element to appear...";Rt.nodeTextContentSetter.call(this.statusDiv,this._getFullStatusText(t)),this.progressBar.show()},Jt.prototype._hideWaitingStatus=function(e){var i=this;return new Pt(function(t){Rt.setTimeout.call(ke,function(){i.state.waiting||i.state.debugging||(kt.removeClass(i.statusBar,Kt),kt.removeClass(i.statusBar,jt),i.progressBar.determinateIndicator.reset(),i._resetState()),t()},e?0:500)})},Jt.prototype._showDebuggingStatus=function(t){var n=this;return new Pt(function(i){n.state.debugging=!0,n.state.locked=!0,t?(n.buttons.removeChild(n.nextButton),n.buttons.removeChild(n.resumeButton),n.buttons.appendChild(n.finishButton),Rt.nodeTextContentSetter.call(n.statusDiv,n._getFullStatusText("Test failed")),kt.removeClass(n.statusBar,Kt),kt.addClass(n.statusBar,jt)):Rt.nodeTextContentSetter.call(n.statusDiv,n._getFullStatusText("Debugging test...")),n.actionsContainer.style.display="",n.unlockButton.style.display="",n._bindClickOnce([n.resumeButton,n.nextButton,n.finishButton],function(t){var e=qt.containsElement(n.nextButton,t.target);n._resetState(),i(e)})})},Jt.prototype._setWaitingStatus=function(t,e){var i=this;this.state.waiting=!0,this.progressBar.determinateIndicator.start(t,e),this.showingTimeout=Rt.setTimeout.call(ke,function(){i.showingTimeout=null,i._showWaitingStatus()},300)},Jt.prototype._resetWaitingStatus=function(t){this.state.waiting=!1,this.progressBar.determinateIndicator.stop(),t?kt.addClass(this.statusBar,Kt):kt.addClass(this.statusBar,jt);var e=this.showingTimeout&&t;return this.showingTimeout&&(Rt.clearTimeout.call(ke,this.showingTimeout),this.showingTimeout=null,t||this._showWaitingStatus()),this._hideWaitingStatus(e)},Jt.prototype.hidePageLoadingStatus=function(){this.state.created||this._create(),this.progressBar.indeterminateIndicator.stop(),this._resetState()},Jt.prototype.showDebuggingStatus=function(t){return this._stopAnimation(),Ht.set(this.statusBar,"opacity",1),Ht.set(this.statusBar,"visibility",""),this.state.hiden=!1,this._showDebuggingStatus(t)},Jt.prototype.showWaitingElementStatus=function(t){this.state.assertionRetries||this._setWaitingStatus(t)},Jt.prototype.hideWaitingElementStatus=function(t){return this.state.assertionRetries?Pt.resolve():this._resetWaitingStatus(t)},Jt.prototype.showWaitingAssertionRetriesStatus=function(t,e){this.state.assertionRetries=!0,this._setWaitingStatus(t,e)},Jt.prototype.hideWaitingAssertionRetriesStatus=function(t){var e=this;return this._resetWaitingStatus(t).then(function(){e.state.assertionRetries=!1})},Jt.prototype.setStatusPrefix=function(t){this.contextStorage.setItem(Yt,t),Rt.nodeTextContentSetter.call(this.statusDiv,this._getFullStatusText(""))},Jt);function Jt(t,e,i,n){var s=Tt.call(this)||this;return s.UNLOCK_PAGE_BTN_CLICK="testcafe|ui|status-bar|unlock-page-btn-click",s.userAgent=t,s.fixtureName=e,s.testName=i,s.contextStorage=n,s.statusBar=null,s.infoContainer=null,s.actionsContainer=null,s.icon=null,s.resumeButton=null,s.finishButton=null,s.nextButton=null,s.statusDiv=null,s.buttons=null,s.progressBar=null,s.animationInterval=null,s.showingTimeout=null,s.windowHeight=Re.documentElement?Ht.getHeight(ke):ke.innerHeight,s.state={created:!1,showing:!1,hiding:!1,debugging:!1,waiting:!1,assertionRetries:!1,hidden:!1},s.currentView=null,s._createBeforeReady(),s._initChildListening(),s}var Qt,Zt=i.sendRequestToFrame,$t=e.eventSandbox.message,te=(st(ee,Qt=Xt),ee.prototype.showWaitingElementStatus=function(t){$t.sendServiceMsg({cmd:Bt,timeout:t},ke.top)},ee.prototype.hideWaitingElementStatus=function(t){return Zt({cmd:Ut,waitingSuccess:t},Dt,ke.top)},ee.prototype.showWaitingAssertionRetriesStatus=function(t){$t.sendServiceMsg({cmd:Mt,timeout:t},ke.top)},ee.prototype.hideWaitingAssertionRetriesStatus=function(t){return Zt({cmd:At,waitingSuccess:t},Vt,ke.top)},ee);function ee(){return Qt.call(this)||this}var ie="ui|cursor|move|request",ne="ui|cursor|leftbuttondown|request",se="ui|cursor|rightbuttondown|request",oe="ui|cursor|buttonup|request",ae="ui|cursor|move|response",re="ui|cursor|leftbuttondown|response",le="ui|cursor|rightbuttondown|response",ue="ui|cursor|buttonup|response",he=e.Promise,ce=e.shadowUI,de=e.utils.browser,pe=e.utils.featureDetection,me=e.eventSandbox.message,ge=i.styleUtils,fe=i.positionUtils,ve="l-mouse-down",ye="r-mouse-down",Ce=[ve,ye].join(" ");me.on(me.SERVICE_MSG_RECEIVED_EVENT,function(t){var e,i=t.message;switch(i.cmd){case ie:e=fe.getIframePointRelativeToParentFrame({x:i.x,y:i.y},t.source),Ee.move(e.x,e.y).then(function(){return me.sendServiceMsg({cmd:ae},t.source)});break;case ne:Ee.leftButtonDown().then(function(){return me.sendServiceMsg({cmd:re},t.source)});break;case se:Ee.rightButtonDown().then(function(){return me.sendServiceMsg({cmd:le},t.source)});break;case oe:Ee.buttonUp().then(function(){return me.sendServiceMsg({cmd:ue},t.source)})}});var Ee={cursorElement:null,x:50,y:50,pointerOffsetX:0,pointerOffsetY:0,_createElement:function(){this.cursorElement=Re.createElement("div"),ce.addClass(this.cursorElement,"cursor"),pe.isTouchDevice&&!de.isIE&&(ce.addClass(this.cursorElement,"touch"),this.pointerOffsetX=Math.ceil(ge.getWidth(this.cursorElement)/2),this.pointerOffsetY=Math.ceil(ge.getHeight(this.cursorElement)/2)),r.element().appendChild(this.cursorElement)},isVisible:function(){return this.cursorElement&&"hidden"!==ge.get(this.cursorElement,"visibility")},hide:function(){this.cursorElement||this._createElement(),ge.set(this.cursorElement,"visibility","hidden")},show:function(){this.cursorElement||this._createElement(),ge.set(this.cursorElement,"visibility","")},move:function(t,e){return this.x=t,this.y=e,this.cursorElement||this._createElement(),ge.set(this.cursorElement,{left:this.x-this.pointerOffsetX+"px",top:this.y-this.pointerOffsetY+"px"}),he.resolve()},leftButtonDown:function(){return this.cursorElement||this._createElement(),ce.removeClass(this.cursorElement,Ce),ce.addClass(this.cursorElement,ve),he.resolve()},rightButtonDown:function(){return this.cursorElement||this._createElement(),ce.removeClass(this.cursorElement,Ce),ce.addClass(this.cursorElement,ye),he.resolve()},buttonUp:function(){return this.cursorElement||this._createElement(),ce.removeClass(this.cursorElement,Ce),he.resolve()}},_e=e.utils.browser.isIE?1:0,we={move:function(t,e){var i={cmd:ie,x:t+_e,y:e+_e};return o.sendRequestToFrame(i,ae,ke.parent)},leftButtonDown:function(){return o.sendRequestToFrame({cmd:ne},re,ke.parent)},rightButtonDown:function(){return o.sendRequestToFrame({cmd:se},le,ke.parent)},buttonUp:function(){return o.sendRequestToFrame({cmd:oe},ue,ke.parent)}},Se={screenshotMark:null,_createMark:function(){this.screenshotMark=Re.createElement("img"),s.shadowUI.addClass(this.screenshotMark,"screenshot-mark"),this.screenshotMark.style.right=10/ke.devicePixelRatio+"px",this.screenshotMark.style.width=32/ke.devicePixelRatio+"px",this.screenshotMark.style.height=10/ke.devicePixelRatio+"px",this.hide(),s.shadowUI.getRoot().appendChild(this.screenshotMark)},hide:function(){this.screenshotMark&&(this.screenshotMark.style.visibility="hidden")},show:function(t){this.screenshotMark||this._createMark(),s.nativeMethods.imageSrcSetter.call(this.screenshotMark,t),this.screenshotMark.style.visibility=""}},Ie=e.Promise,be=e.eventSandbox.message,xe=i.sendRequestToFrame,Te="ui|hide|request",Be="ui|hide|response",Ue="ui|show|request",De="ui|show|response";be.on(be.SERVICE_MSG_RECEIVED_EVENT,function(t){t.message.cmd===Te?(r.hide(),be.sendServiceMsg({cmd:Be},t.source)):t.message.cmd===Ue&&(r.show(),be.sendServiceMsg({cmd:De},t.source))});var Me={};Me.uiRoot=r,Me.cursorUI=Ee,Me.iframeCursorUI=we,Me.selectElement=n,Me.modalBackground=N,Me.ProgressPanel=et,Me.StatusBar=Xt,Me.IframeStatusBar=te,Me.hide=function(t){return t?xe({cmd:Te},Be,ke.top):(r.hide(),Ie.resolve())},Me.show=function(t){return t?xe({cmd:Ue},De,ke.top):(r.show(),Ie.resolve())},Me.showScreenshotMark=function(t){return Se.show(t)},Me.hideScreenshotMark=function(){return Se.hide()};var Ae=e.nativeMethods,Ve=e.EVENTS.evalIframeScript;Ae.objectDefineProperty(ke,"%testCafeUI%",{configurable:!0,value:Me}),e.on(Ve,function(t){return Pe(Ae.contentWindowGetter.call(t.iframe))})}(ke["%hammerhead%"],ke["%testCafeCore%"],ke["%hammerhead%"].Promise)}(window);