!function Ou(Yu){var Fu=Yu.document;!function(t,m,o){var h="default"in t?t.default:t,E="default"in m?m.default:m;o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o;var a=h.Promise,l=h.eventSandbox.message,u="automation|scroll|request",c="automation|scroll|response";l.on(l.SERVICE_MSG_RECEIVED_EVENT,function(t){var e,n,i,o,r,s;t.message.cmd===u&&(n=(e=t.message).offsetX,i=e.offsetY,o=e.maxScrollMargin,r=m.domUtils.findIframeByWindow(t.source),(s=new f(r,{offsetX:n,offsetY:i})).maxScrollMargin=o,s.run().then(function(){return l.sendServiceMsg({cmd:c},t.source)}))});var f=(d.prototype._isScrollValuesChanged=function(t,e){return m.styleUtils.getScrollLeft(t)!==e.left||m.styleUtils.getScrollTop(t)!==e.top},d.prototype._setScroll=function(t,e){var n=this,i=e.left,o=e.top,r=m.domUtils.isHtmlElement(t)?m.domUtils.findDocument(t):t,s={left:m.styleUtils.getScrollLeft(r),top:m.styleUtils.getScrollTop(r)},i=Math.max(i,0),o=Math.max(o,0),l=m.scrollController.waitForScroll(r);return m.styleUtils.setScrollLeft(r,i),m.styleUtils.setScrollTop(r,o),this._isScrollValuesChanged(r,s)?l=l.then(function(){n.scrollWasPerformed=n.scrollWasPerformed||n._isScrollValuesChanged(r,s)}):(l.cancel(),a.resolve())},d.prototype._getScrollToPoint=function(t,e,n){var i=e.x,o=e.y,r=Math.floor(t.width/2),s=Math.floor(Math.floor(t.height/2)),l=this.scrollToCenter?r:Math.min(n.left,r),a=this.scrollToCenter?s:Math.min(n.top,s),u=i>=t.scroll.left+t.width-l,c=i<=t.scroll.left+l,h=o>=t.scroll.top+t.height-a,f=o<=t.scroll.top+a,d=t.scroll.left,m=t.scroll.top;return u?d=i-t.width+l:c&&(d=i-l),h?m=o-t.height+a:f&&(m=o-a),{left:d,top:m}},d.prototype._getScrollToFullChildView=function(t,e,n){var i,o,r,s,l=null,a=null,u=t.width>=e.width,c=t.height>=e.height,h=m.positionUtils.calcRelativePosition(e,t);return u&&(i=t.width-e.width,o=Math.min(n.left,i),this.scrollToCenter&&(o=i/2),h.left<o?l=Math.round(t.scroll.left+h.left-o):h.right<o&&(l=Math.round(t.scroll.left+Math.min(h.left,-h.right)+o))),c&&(r=t.height-e.height,s=Math.min(n.top,r),this.scrollToCenter&&(s=r/2),h.top<s?a=Math.round(t.scroll.top+h.top-s):h.bottom<s&&(a=Math.round(t.scroll.top+Math.min(h.top,-h.bottom)+s))),{left:l,top:a}},d._getChildPoint=function(t,e,n){return{x:e.left-t.left+t.scroll.left+e.border.left+n.x,y:e.top-t.top+t.scroll.top+e.border.top+n.y}},d.prototype._getScrollPosition=function(t,e,n,i){var o=d._getChildPoint(t,e,n),r=this._getScrollToPoint(t,o,i),s=this._getScrollToFullChildView(t,e,i);return{left:Math.max(null===s.left?r.left:s.left,0),top:Math.max(null===s.top?r.top:s.top,0)}},d._getChildPointAfterScroll=function(t,e,n,i){return{x:Math.round(e.left+t.scroll.left-n.left+i.x),y:Math.round(e.top+t.scroll.top-n.top+i.y)}},d.prototype._isChildFullyVisible=function(t,e,n){var i=d._getChildPointAfterScroll(t,e,t.scroll,n),o=i.x,r=i.y,s=this._getScrollPosition(t,e,n,{left:0,top:0}),l=s.left,a=s.top;return!this._isTargetElementObscuredInPoint(o,r)&&l===t.scroll.left&&a===t.scroll.top},d.prototype._scrollToChild=function(t,e,n){for(var i=m.positionUtils.getClientDimensions(t),o=m.positionUtils.getClientDimensions(e),r=m.styleUtils.getInnerWidth(Yu),s=m.styleUtils.getInnerHeight(Yu),l=i.scroll,a=!this._isChildFullyVisible(i,o,n);a;){l=this._getScrollPosition(i,o,n,this.maxScrollMargin);var u=d._getChildPointAfterScroll(i,o,l,n),c=u.x,h=u.y,f=this._isTargetElementObscuredInPoint(c,h);this.maxScrollMargin.left+=20,this.maxScrollMargin.left>=r&&(this.maxScrollMargin.left=50,this.maxScrollMargin.top+=20),a=f&&this.maxScrollMargin.top<s}return this.maxScrollMargin={left:50,top:50},this._setScroll(t,l)},d.prototype._scrollElement=function(){if(!m.styleUtils.hasScroll(this.element))return a.resolve();var t=m.positionUtils.getClientDimensions(this.element),e=this._getScrollToPoint(t,{x:this.offsetX,y:this.offsetY},this.maxScrollMargin);return this._setScroll(this.element,e)},d.prototype._scrollParents=function(){var e=this,n=m.styleUtils.getScrollableParents(this.element),i=this.element,o=this.offsetX-Math.round(m.styleUtils.getScrollLeft(i)),r=this.offsetY-Math.round(m.styleUtils.getScrollTop(i)),s=null,l=null;return m.promiseUtils.times(n.length,function(t){return e._scrollToChild(n[t],i,{x:o,y:r}).then(function(){s=m.positionUtils.getClientDimensions(i),l=m.positionUtils.getClientDimensions(n[t]),o+=s.left-l.left+l.border.left,r+=s.top-l.top+l.border.top,i=n[t]})}).then(function(){return Yu.top===Yu||e.skipParentFrames?a.resolve():m.sendRequestToFrame({cmd:u,offsetX:o,offsetY:r,maxScrollMargin:e.maxScrollMargin},c,Yu.parent)})},d._getFixedAncestorOrSelf=function(t){return m.domUtils.findParent(t,!0,m.styleUtils.isFixedElement)},d.prototype._isTargetElementObscuredInPoint=function(t,e){var n=m.positionUtils.getElementFromPoint(t,e);if(!n)return!1;var i=d._getFixedAncestorOrSelf(n);return i&&!i.contains(this.element)},d.prototype.run=function(){var t=this;return this._scrollElement().then(function(){return t._scrollParents()}).then(function(){return t.scrollWasPerformed})},d);function d(t,e){this.element=t,this.offsetX=e.offsetX,this.offsetY=e.offsetY,this.scrollToCenter=e.scrollToCenter,this.skipParentFrames=e.skipParentFrames,this.raiseEvents=e.raiseEvents,this.maxScrollMargin={left:50,top:50},this.scrollWasPerformed=!1}var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function e(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var r=h.utils.browser;function s(t,e,n){var i=r.isFirefox?Math.ceil:Math.round,o=m.positionUtils.getOffsetPosition(t,i);return{x:(t===Fu.documentElement?0:o.left)+e,y:(t===Fu.documentElement?0:o.top)+n}}function p(t){if(!t)return null;var e=Yu.screenLeft||Yu.screenX,n=Yu.screenTop||Yu.screenY;return{x:e+t.x,y:n+t.y}}function n(t){var e=t/2;return e<1?0:Math.round(e)}function v(t){var e=m.positionUtils.getElementRectangle(t);return{offsetX:n(e.width),offsetY:n(e.height)}}function g(t,e,n){var i=v(t);if(e="number"==typeof e?Math.round(e):i.offsetX,n="number"==typeof n?Math.round(n):i.offsetY,0<e&&0<n)return{offsetX:e,offsetY:n};var o=m.positionUtils.getClientDimensions(t),r=Math.round(Math.max(t.scrollWidth,o.width)),s=Math.round(Math.max(t.scrollHeight,o.height)),l=o.scrollbar.right+o.border.left+o.border.right+r,a=o.scrollbar.bottom+o.border.top+o.border.bottom+s;return{offsetX:e<0?l+e:e,offsetY:n<0?a+n:n}}var y=E.domUtils,S=Yu.top===Yu?o.cursorUI:o.iframeCursorUI,b={x:-1,y:-1,currentActiveWindow:Yu.top,_ensureActiveWindow:function(){var t;this.currentActiveWindow!==Yu&&this.currentActiveWindow!==Yu.parent&&((t=y.findIframeByWindow(this.currentActiveWindow))&&y.isElementInDocument(t)||(this.currentActiveWindow=Yu))},get active(){return this._ensureActiveWindow(),this.currentActiveWindow===Yu},set activeWindow(t){this.currentActiveWindow=t},get activeWindow(){return this._ensureActiveWindow(),this.currentActiveWindow},get position(){return{x:this.x,y:this.y}},get visible(){return Yu.top===Yu&&S.isVisible()},move:function(t,e){return this.x=t,this.y=e,S.move(this.x,this.y)},hide:function(){this.visible&&S.hide()},show:function(){Yu.top===Yu&&S.show()},leftButtonDown:function(){return S.leftButtonDown()},rightButtonDown:function(){return S.rightButtonDown()},buttonUp:function(){return S.buttonUp()}},P=h.utils.browser,x=h.Promise,_=h.nativeMethods,A=E.positionUtils,C=E.domUtils;function w(t,e,n){var i=null;return o.hide(n).then(function(){return i=A.getElementFromPoint(t,e),o.show(n)}).then(function(){return i})}function T(t,e,n){var i=A.getElementFromPoint(t,e),o=C.containsElement(n,i)&&_.nodeTextContentGetter.call(i).length;return i&&i===n||o?i:null}function M(t,e){if(!e||!C.isDomElement(e)||!t||t===e)return t;if("tref"===C.getTagName(e))return e;var n,i,o,r="area"===C.getTagName(e)&&C.isImgElement(t);if(P.isFirefox&&r)return n=t,i=e,(o=C.closest(i,"map"))&&o.name===n.useMap.substring(1)?i:n;var s=C.isAnchorElement(e)||C.getParents(e,"a").length,l=s&&C.containsElement(e,t)&&_.nodeTextContentGetter.call(t).length;if(!s||l||!_.nodeTextContentGetter.call(e).length)return t;var a=e.getBoundingClientRect();return T(a.right-1,a.top+1,e)||T(a.left+1,a.bottom-1,e)||t}function U(n,i,o){var r=Yu!==Yu.top,s=null;return w(n,i).then(function(t){s=t;var e=x.resolve(t);return!s&&r&&0<n&&0<i&&(e=e.then(function(){return w(n,i,!0)}).then(function(t){return s=t})),e.then(function(t){return M(t,o)}).then(function(t){return{element:t,corrected:t!==s}})})}function D(){var t=b.position;return U(t.x,t.y).then(function(t){return t.element})}var I={elementIsInvisibleError:"elementIsInvisibleError",foundElementIsNotTarget:"foundElementIsNotTarget"},k=(Object.defineProperty(B.prototype,"mouseActionStepDelay",{get:function(){return 1===this.speedFactor?10:400*(1-this.speedFactor)},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"keyActionStepDelay",{get:function(){return 1===this.speedFactor?10:200*(1-this.speedFactor)},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"cursorSpeed",{get:function(){return Math.pow(400,this.speedFactor)/4},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"draggingSpeed",{get:function(){return Math.pow(16,this.speedFactor)/4},enumerable:!1,configurable:!0}),B);function B(t){this.speedFactor=t||1}var N=(O.prototype._getAssignableProperties=function(){throw new Error("Not implemented")},O.prototype._assignFrom=function(t,e,n){if(void 0===n&&(n={}),t)for(var i=this._getAssignableProperties(),o=0;o<i.length;o++){for(var r,s=i[o],l=s.name,a=s.type,u=s.required,c=s.init,h=s.defaultValue,f=l.split("."),d=f.length-1,m=f[d],p=t,v=this,g=0;g<d&&p&&v;g++)p=p[f[g]],v=v[f[g]];v&&"defaultValue"in i[o]&&(v[l]=h),p&&v&&(void 0===(r=p[m])&&!u||(e&&a&&a(l,r),v[m]=c?c(l,r,n):r))}},O);function O(){}function Y(i){return function(t,e){var n=typeof e;if("number"!=n)throw new i(t,n);if(isNaN(e)||!isFinite(e)||e!==Math.floor(e))throw new i(t,e)}}function F(t){this.code=t,this.isTestCafeError=!0,this.callsite=null}var L,K="E1",X="E2",V="E3",R="E4",W="E5",H="E6",G="E7",z="E8",q="E9",j="E10",$="E11",Z="E12",J="E14",Q="E15",tt="E16",et="E17",nt="E18",it="E19",ot="E20",rt="E21",st="E22",lt="E23",at="E24",ut="E26",ct="E27",ht="E28",ft="E29",dt="E30",mt="E31",pt="E32",vt="E33",gt="E34",Et="E35",yt="E36",St="E37",bt="E38",Pt="E39",xt="E40",_t="E41",At="E42",Ct="E43",wt="E44",Tt="E45",Mt="E46",Ut="E47",Dt="E48",It="E49",kt="E50",Bt="E51",Nt="E52",Ot="E53",Yt="E54",Ft="E55",Lt="E56",Kt="E57",Xt="E58",Vt="E59",Rt="E60",Wt="E61",Ht="E62",Gt="E63",zt="E64",qt="E65",jt="E66",$t="E67",Zt="E68",Jt="E69",Qt="E70",te="E71",ee="E72",ne=(e(ie,L=F),ie);function ie(t,e,n){var i=L.call(this,t)||this;return i.optionName=e,i.actualValue=n,i}var oe,re,se,le,ae=(e(ue,oe=F),ue);function ue(t,e,n){var i=oe.call(this,t)||this;return i.argumentName=e,i.actualValue=n,i}function ce(t){var e=re.call(this,z)||this;return e.callsite=t,e}function he(t){var e=se.call(this,It)||this;return e.instantiationCallsiteName=t,e}function fe(t){var e=le.call(this,kt)||this;return e.instantiationCallsiteName=t,e}e(ce,re=F),e(he,se=F),e(fe,le=F);var de,me,pe,ve,ge,Ee,ye,Se,be,Pe,xe,_e,Ae,Ce,we,Te,Me,Ue=(e(De,de=F),De);function De(t,e){var n=e.apiFnChain,i=e.apiFnIndex,o=de.call(this,t)||this;return o.apiFnChain=n,o.apiFnIndex=i,o}function Ie(){return me.call(this,Bt)||this}function ke(t,e){var n=pe.call(this,Nt,e)||this;return n.callsite=t,n}function Be(t,e){var n=ve.call(this,Yt)||this;return n.url=e,n.errMsg=t,n}function Ne(t,e){var n=ge.call(this,K)||this;return n.errStack=t,n.pageDestUrl=e,n}function Oe(t,e){var n=Ee.call(this,X)||this;return n.errMsg=String(t.rawMessage||t),n.callsite=t.callsite||e,n.originError=t,n}function Ye(t){var e=ye.call(this,V)||this;return e.objType=typeof t,e.objStr=String(t),e}function Fe(t,e){var n=Se.call(this,R)||this;return n.errMsg=String(e),n.instantiationCallsiteName=t,n}function Le(t,e,n){var i=be.call(this,W,e,n)||this;return i.errMsg=String(e),i.property=n,i.instantiationCallsiteName=t,i}function Ke(t){var e=Pe.call(this,H)||this;return e.errMsg=String(t),e}function Xe(t){var e=xe.call(this,G)||this;return e.errMsg=String(t),e}function Ve(t){var e=_e.call(this,zt)||this;return e.errMsg=String(t),e}function Re(t,e){var n=Ae.call(this,qt)||this;return n.errMsg=String(t),n.moduleName=e,n}function We(t,e){var n=Ce.call(this,Ot)||this;return n.errMsg=String(t),n.callsite=e,n}function He(t,e,n,i){var o=we.call(this,Vt,t,e)||this;return o.errMsg=i?n.rawMessage:n.message,o.originError=n,o}function Ge(t){var e=Te.call(this,Rt)||this;return e.callsite=t,e}function ze(t){var e=Me.call(this,Wt)||this;return e.callsite=t,e}e(Ie,me=F),e(ke,pe=Ue),e(Be,ve=F),e(Ne,ge=F),e(Oe,Ee=F),e(Ye,ye=F),e(Fe,Se=F),e(Le,be=F),e(Ke,Pe=F),e(Xe,xe=F),e(Ve,_e=F),e(Re,Ae=F),e(We,Ce=F),e(He,we=ae),e(Ge,Te=F),e(ze,Me=F);var qe,je=(e($e,qe=ne),$e);function $e(t,e){return qe.call(this,q,t,e)||this}var Ze,Je=(e(Qe,Ze=ne),Qe);function Qe(t,e){return Ze.call(this,j,t,e)||this}var tn,en,nn=(e(on,tn=ne),on);function on(t,e){return tn.call(this,$,t,e)||this}function rn(t,e){return en.call(this,Q,t,e)||this}e(rn,en=ae);var sn,ln,an,un,cn,hn,fn,dn,mn,pn,vn,gn,En,yn,Sn,bn,Pn,xn,_n,An,Cn,wn,Tn,Mn,Un,Dn,In,kn,Bn,Nn,On,Yn,Fn,Ln,Kn,Xn,Vn,Rn,Wn,Hn,Gn,zn,qn,jn,$n,Zn,Jn,Qn=(e(ti,sn=ne),ti);function ti(t,e){return sn.call(this,Z,t,e)||this}function ei(t){var e=ln.call(this,J)||this;return e.actualType=t,e}function ni(t,e){return an.call(this,tt,t,e)||this}function ii(t,e){return un.call(this,et,t,e)||this}function oi(t,e){return cn.call(this,ot,t,e)||this}function ri(t,e){return hn.call(this,rt,t,e)||this}function si(t,e){return fn.call(this,st,t,e)||this}function li(t,e){return dn.call(this,nt,t,e)||this}function ai(t,e,n){var i=mn.call(this,it,t,e)||this;return i.elementIndex=n,i}function ui(t,e){return pn.call(this,Ut,t,e)||this}function ci(t,e){return vn.call(this,bt,t,e)||this}function hi(t,e,n){var i=gn.call(this,lt)||this;return i.selectorName=t,i.errMsg=n?e.rawMessage:e.message,i.originError=e,i}function fi(t){return En.call(this,at,t)||this}function di(){return yn.call(this,ut)||this}function mi(t){var e=Sn.call(this,ct)||this;return e.nodeDescription=t,e}function pi(t,e){var n=bn.call(this,ht,e)||this;return n.argumentName=t,n}function vi(t){var e=Pn.call(this,ft)||this;return e.argumentName=t,e}function gi(t,e){var n=xn.call(this,dt)||this;return n.argumentName=t,n.nodeDescription=e,n}function Ei(){return _n.call(this,mt)||this}function yi(){return An.call(this,pt)||this}function Si(t){var e=Cn.call(this,vt)||this;return e.argumentName=t,e}function bi(){return wn.call(this,Et)||this}function Pi(t){var e=Tn.call(this,yt)||this;return e.argumentName=t,e}function xi(t,e){var n=Mn.call(this,St)||this;return n.filePaths=t,n.scannedFilePaths=e,n}function _i(){return Un.call(this,gt)||this}function Ai(t,e){var n=Dn.call(this,_t)||this;return n.properties=t?"scrollTargetY property":e?"scrollTargetX property":"scrollTargetX and scrollTargetY properties",n}function Ci(t,e,n,i,o){var r=In.call(this,jt)||this;return r.callsite=o,r.expression=e,r.line=n,r.column=i,r.originError=t,r.errMsg=t.message||String(t),r}function wi(t,e,n,i,o){var r=kn.call(this,$t)||this;return r.callsite=o,r.expression=e,r.line=n,r.column=i,r.originError=t,r.errCallsite=t.callsite,r}function Ti(t){var e=Bn.call(this,Ft)||this;return e.callsite=t,e}function Mi(t,e){var n=Nn.call(this,Kt)||this;return t<=0?e<=0?(n.verb="are",n.dimensions="width and height"):(n.verb="is",n.dimensions="width"):(n.verb="is",n.dimensions="height"),n}function Ui(t,e){var n=On.call(this,Lt)||this;return n.screenshotPath=t,n.forbiddenCharsList=e,n}function Di(t){var e=Yn.call(this,Xt)||this;return e.callsite=t,e}function Ii(){return Fn.call(this,xt)||this}function ki(){return Ln.call(this,Pt)||this}function Bi(){return Kn.call(this,At)||this}function Ni(){return Xn.call(this,Jt)||this}function Oi(){return Vn.call(this,Zt)||this}function Yi(){return Rn.call(this,Qt)||this}function Fi(){return Wn.call(this,te)||this}function Li(){return Hn.call(this,Ct)||this}function Ki(){return Gn.call(this,wt)||this}function Xi(t,e){var n=zn.call(this,Tt)||this;return n.dialogType=t,n.pageUrl=e,n}function Vi(t,e,n){var i=qn.call(this,Mt)||this;return i.dialogType=t,i.errMsg=e,i.pageUrl=n,i}function Ri(t){var e=jn.call(this,Dt)||this;return e.actualType=t,e}function Wi(t,e,n){var i=$n.call(this,Gt)||this;return i.errMsg=String(t),i.hookClassName=e,i.methodName=n,i}function Hi(t,e){var n=Zn.call(this,Ht)||this;return n.methodName=t,n.hookClassName=e,n}function Gi(){return Jn.call(this,ee)||this}e(ei,ln=F),e(ni,an=ae),e(ii,un=ae),e(oi,cn=ae),e(ri,hn=ae),e(si,fn=ae),e(li,dn=ae),e(ai,mn=ae),e(ui,pn=ae),e(ci,vn=ae),e(hi,gn=F),e(fi,En=Ue),e(di,yn=F),e(mi,Sn=F),e(pi,bn=Ue),e(vi,Pn=F),e(gi,xn=F),e(Ei,_n=F),e(yi,An=F),e(Si,Cn=F),e(bi,wn=F),e(Pi,Tn=F),e(xi,Mn=F),e(_i,Un=F),e(Ai,Dn=F),e(Ci,In=F),e(wi,kn=F),e(Ti,Bn=F),e(Mi,Nn=F),e(Ui,On=F),e(Di,Yn=F),e(Ii,Fn=F),e(ki,Ln=F),e(Bi,Kn=F),e(Ni,Xn=F),e(Oi,Vn=F),e(Yi,Rn=F),e(Fi,Wn=F),e(Li,Hn=F),e(Ki,Gn=F),e(Xi,zn=F),e(Vi,qn=F),e(Ri,jn=F),e(Wi,$n=F),e(Hi,Zn=F),e(Gi,Jn=F);var zi,qi,ji,$i,Zi,Ji=Y(je),Qi=(qi=Y(zi=Je),function(t,e){if(qi(t,e),e<0)throw new zi(t,e)}),to=(ji=nn,function(t,e){var n=typeof e;if("boolean"!=n)throw new ji(t,n)}),eo=($i=Qn,function(t,e){var n=typeof e;if("number"!=n)throw new $i(t,n);if(isNaN(e)||e<.01||1<e)throw new $i(t,e)}),no=(e(io,Zi=N),io.prototype._getAssignableProperties=function(){return[{name:"speed",type:eo}]},io);function io(t,e){var n=Zi.call(this)||this;return n.speed=null,n._assignFrom(t,e),n}var oo,ro=(e(so,oo=no),so.prototype._getAssignableProperties=function(){return oo.prototype._getAssignableProperties.call(this).concat([{name:"offsetX",type:Ji},{name:"offsetY",type:Ji}])},so);function so(t,e){var n=oo.call(this)||this;return n.offsetX=null,n.offsetY=null,n._assignFrom(t,e),n}var lo,ao,uo=(e(co,lo=ro),co.prototype._getAssignableProperties=function(){return lo.prototype._getAssignableProperties.call(this).concat([{name:"scrollToCenter",type:to},{name:"skipParentFrames",type:to}])},co);function co(t,e){var n=lo.call(this)||this;return n.scrollToCenter=!1,n.skipParentFrames=!1,n._assignFrom(t,e),n}function ho(t,e){var n=ao.call(this)||this;return n.scrollTargetX=null,n.scrollTargetY=null,n.includeMargins=!1,n.includeBorders=!0,n.includePaddings=!0,n.crop={left:null,right:null,top:null,bottom:null},n._assignFrom(t,e),n}e(ho,ao=no),ho.prototype._getAssignableProperties=function(){return ao.prototype._getAssignableProperties.call(this).concat([{name:"scrollTargetX",type:Ji},{name:"scrollTargetY",type:Ji},{name:"crop.left",type:Ji},{name:"crop.right",type:Ji},{name:"crop.top",type:Ji},{name:"crop.bottom",type:Ji},{name:"includeMargins",type:to},{name:"includeBorders",type:to},{name:"includePaddings",type:to}])};var fo,mo=(e(po,fo=ro),po.prototype._getAssignableProperties=function(){return fo.prototype._getAssignableProperties.call(this).concat([{name:"modifiers.ctrl",type:to},{name:"modifiers.alt",type:to},{name:"modifiers.shift",type:to},{name:"modifiers.meta",type:to}])},po);function po(t,e){var n=fo.call(this)||this;return n.modifiers={ctrl:!1,alt:!1,shift:!1,meta:!1},n._assignFrom(t,e),n}var vo,go=(e(Eo,vo=mo),Eo.prototype._getAssignableProperties=function(){return vo.prototype._getAssignableProperties.call(this).concat([{name:"caretPos",type:Qi}])},Eo);function Eo(t,e){var n=vo.call(this)||this;return n.caretPos=null,n._assignFrom(t,e),n}var yo,So=(e(bo,yo=mo),bo.prototype._getAssignableProperties=function(){return yo.prototype._getAssignableProperties.call(this).concat([{name:"speed"},{name:"minMovingTime"},{name:"holdLeftButton"},{name:"skipScrolling",type:to},{name:"skipDefaultDragBehavior",type:to}])},bo);function bo(t,e){var n=yo.call(this)||this;return n.speed=null,n.minMovingTime=null,n.holdLeftButton=!1,n.skipScrolling=!1,n.skipDefaultDragBehavior=!1,n._assignFrom(t,e),n}var Po,xo,_o,Ao,Co=(e(wo,Po=go),wo.prototype._getAssignableProperties=function(){return Po.prototype._getAssignableProperties.call(this).concat([{name:"replace",type:to},{name:"paste",type:to}])},wo);function wo(t,e){var n=Po.call(this)||this;return n.replace=!1,n.paste=!1,n._assignFrom(t,e),n}function To(t,e){var n=xo.call(this,t,e)||this;return n.destinationOffsetX=null,n.destinationOffsetY=null,n._assignFrom(t,e),n}function Mo(t,e){var n=_o.call(this)||this;return n.portraitOrientation=!1,n._assignFrom(t,e),n}function Uo(t,e){var n=Ao.call(this)||this;return n.timeout=void 0,n.allowUnawaitedPromise=!1,n._assignFrom(t,e),n}function Do(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Io(t,e,n){for(var i=[],o=null,r=[{x1:n.left,y1:n.top,x2:n.left,y2:n.bottom,isHorizontal:!1},{x1:n.right,y1:n.top,x2:n.right,y2:n.bottom,isHorizontal:!1},{x1:n.left,y1:n.top,x2:n.right,y2:n.top,isHorizontal:!0},{x1:n.left,y1:n.bottom,x2:n.right,y2:n.bottom,isHorizontal:!0}],s=0;s<r.length;s++)(o=function(t,e,n){var i=null;if(n.isHorizontal)return(i=m.positionUtils.getLineXByYCoord(t,e,n.y1))&&i>=n.x1&&i<=n.x2?{x:i,y:n.y1}:null;var o=m.positionUtils.getLineYByXCoord(t,e,n.x1);return o&&o>=n.y1&&o<=n.y2?{x:n.x1,y:o}:null}(t,e,r[s]))&&i.push(o);return i.length?1===i.length||Do(t,i[0])<Do(t,i[1])?i[0]:i[1]:null}e(To,xo=mo),To.prototype._getAssignableProperties=function(){return xo.prototype._getAssignableProperties.call(this).concat([{name:"destinationOffsetX",type:Ji},{name:"destinationOffsetY",type:Ji}])},e(Mo,_o=N),Mo.prototype._getAssignableProperties=function(){return[{name:"portraitOrientation",type:to}]},e(Uo,Ao=N),Uo.prototype._getAssignableProperties=function(){return[{name:"timeout",type:Qi},{name:"allowUnawaitedPromise",type:to}]};var ko=h.Promise,Bo=h.nativeMethods;function No(){return new ko(function(t){return Bo.setTimeout.call(Yu,t,0)})}var Oo=function(){this.enabled=!1,this.dropAllowed=!1,this.element=null,this.dataTransfer=null,this.dataStore=null},Yo=h.utils.browser,Fo=(Lo.prototype.setup=function(){this.dragAndDropMode=!1,this.dropAllowed=!1},Lo.prototype.leaveElement=function(){},Lo.prototype.move=function(){},Lo.prototype.enterElement=function(){},Lo.prototype.dragAndDrop=function(){},Lo.prototype.teardown=function(){},Lo.prototype.run=function(t,e,n,i,o){var r=e&&m.domUtils.isElementInDocument(e),s=e&&m.domUtils.isElementInIframe(e)&&!m.domUtils.getIframeByElement(e);r&&!s||(e=null);var l=t!==e,a=l?m.domUtils.getCommonAncestor(t,e):null;this.setup(),l&&e&&this.leaveElement(t,e,a,n),Yo.isIE&&this.move(t,n),l&&m.domUtils.isElementInDocument(t)&&this.enterElement(t,e,a,n),Yo.isIE||this.move(t,n),this.dragAndDrop(i,t,e,n,o),this.teardown(t,n,e);var u=this.dragAndDropMode,c=this.dropAllowed;return this.dragAndDropMode=!1,this.dropAllowed=!1,{dragAndDropMode:u,dropAllowed:c}},Lo);function Lo(t){var e=t.moveEvent;this.dragAndDropMode=!1,this.dropAllowed=!1,this.moveEvent=e}var Ko=h.eventSandbox.eventSimulator,Xo=h.utils.extend,Vo=h.nativeMethods,Ro=(Wo.leaveElement=function(t,e,n,i){Ko.mouseout(e,Xo({relatedTarget:t},i));for(var o=e;o&&o!==n;)Ko.mouseleave(o,Xo({relatedTarget:t},i)),o=Vo.nodeParentNodeGetter.call(o)},Wo.enterElement=function(t,e,n,i){Ko.mouseover(t,Xo({relatedTarget:e},i));for(var o=t,r=[];o&&o!==n;)r.push(o),o=Vo.nodeParentNodeGetter.call(o);r.reverse();for(var s=0;s<r.length;s++)Ko.mouseenter(r[s],Xo({relatedTarget:e},i))},Wo.move=function(t,e,n){Ko[t](e,n)},Wo);function Wo(){}var Ho=(Go.dragAndDrop=function(t,e,n,i){return Ko.drag(t,i),e!==n&&(m.domUtils.isElementInDocument(e)&&(i.relatedTarget=n,Ko.dragenter(e,i)),n&&(i.relatedTarget=e,Ko.dragleave(n,i))),!Ko.dragover(e,i)},Go);function Go(){}var zo,qo=h.eventSandbox.eventSimulator,jo=(e($o,zo=Fo),$o.prototype.leaveElement=function(t,e,n,i){Ro.leaveElement(t,e,n,i)},$o.prototype.enterElement=function(t,e,n,i){Ro.enterElement(t,e,n,i)},$o.prototype.move=function(t,e){this._needEmulateMoveEvent()&&Ro.move(this.moveEvent,t,e)},$o.prototype.teardown=function(t,e,n){this._needEmulateMoveEvent()&&m.domUtils.isElementInDocument(t)&&t!==n&&qo[this.moveEvent](t,e)},$o.prototype._needEmulateMoveEvent=function(){return"touchmove"!==this.moveEvent||this.holdLeftButton},$o);function $o(t){var e=zo.call(this,t)||this;return e.holdLeftButton=t.holdLeftButton,e}var Zo,Jo=(e(Qo,Zo=Fo),Qo.prototype.setup=function(){Zo.prototype.setup.call(this),this.dragAndDropMode=!0},Qo.prototype.dragAndDrop=function(t,e,n,i){this.dropAllowed=Ho.dragAndDrop(t,e,n,i)},Qo);function Qo(){return null!==Zo&&Zo.apply(this,arguments)||this}var tr,er=h.eventSandbox.eventSimulator,nr=(e(ir,tr=Fo),ir.prototype.setup=function(){tr.prototype.setup.call(this),this.dragAndDropMode=!0},ir.prototype.leaveElement=function(t,e,n,i){Ro.leaveElement(t,e,n,i)},ir.prototype.move=function(t,e){Ro.move(this.moveEvent,t,e)},ir.prototype.enterElement=function(t,e,n,i){Ro.enterElement(t,e,n,i)},ir.prototype.dragAndDrop=function(t,e,n,i,o){var r=er.dragstart(t,i);o.setReadOnlyMode(),r?this.dropAllowed=Ho.dragAndDrop(t,e,n,i):this.dragAndDropMode=!1},ir.prototype.run=function(t,e,n,i,o){return tr.prototype.run.call(this,t,null,n,i,o)},ir);function ir(){return null!==tr&&tr.apply(this,arguments)||this}var or=null,rr=function(){return or},sr=function(t){or=t},lr=h.Promise,ar=h.nativeMethods,ur=h.utils.featureDetection,cr=h.utils.html,hr=h.utils.url,fr=h.eventSandbox.eventSimulator,dr=h.eventSandbox.message,mr=h.eventSandbox.DataTransfer,pr=h.eventSandbox.DragDataStore,vr=E.positionUtils,gr=E.domUtils,Er=E.styleUtils,yr=E.eventUtils,Sr=E.promiseUtils,br=E.sendRequestToFrame,Pr="automation|move|request",xr="automation|move|response";dr.on(dr.SERVICE_MSG_RECEIVED_EVENT,function(t){t.message.cmd===Pr&&(t.source.parent===Yu?_r.onMoveToIframeRequest(t):(h.on(h.EVENTS.beforeUnload,function(){return dr.sendServiceMsg({cmd:xr},t.source)}),_r.onMoveOutRequest(t)))});var _r=(Ar.getTarget=function(t,e,n){var i=!vr.containsOffset(t,e,n),o=i?s(t,e,n):{x:e,y:n};return{element:i?Fu.documentElement:t,offsetX:o.x,offsetY:o.y}},Ar.onMoveToIframeRequest=function(t){var e={x:t.message.endX,y:t.message.endY},n=t.source,i=gr.findIframeByWindow(n),o=Er.getBordersWidth(i),r=Er.getElementPadding(i),s=vr.getIframeClientCoordinates(i),l=vr.getIframePointRelativeToParentFrame(e,n),a=b.position,u=vr.isInRectangle(a,s)?a:Io(a,l,s),c={x:u.x-s.left,y:u.y-s.top},h=new Ar(i,new So({modifiers:t.message.modifiers,offsetX:c.x+o.left+r.left,offsetY:c.y+o.top+r.top,speed:t.message.speed,skipScrolling:!0},!1)),f={cmd:xr,x:c.x,y:c.y};b.activeWindow!==n?h.run().then(function(){b.activeWindow=n,dr.sendServiceMsg(f,n)}):dr.sendServiceMsg(f,n)},Ar.onMoveOutRequest=function(t){var e=t.source,n={left:t.message.left,right:t.message.right,top:t.message.top,bottom:t.message.bottom};if(!t.message.iframeUnderCursor){var i=t.message,o=i.startX,r=i.startY,s=o-n.left,l=r-n.top,a=rr();return a&&(fr.mouseout(a,{clientX:s,clientY:l,relatedTarget:null}),fr.mouseleave(a,{clientX:s,clientY:l,relatedTarget:null})),void dr.sendServiceMsg({cmd:xr},e)}var u,c=b.position,h=Io({x:n.left+c.x,y:n.top+c.y},{x:t.message.endX,y:t.message.endY},n);h?(u=new So({modifiers:t.message.modifiers,offsetX:h.x-n.left,offsetY:h.y-n.top,speed:t.message.speed,skipScrolling:!0},!1),new Ar(Fu.documentElement,u).run().then(function(){var t={cmd:xr,x:h.x,y:h.y};b.activeWindow=e,dr.sendServiceMsg(t,e)})):dr.sendServiceMsg({cmd:xr,x:n.left,y:n.top},e)},Ar.prototype._getTargetClientPoint=function(){var t=Er.getElementScroll(this.element);if(gr.isHtmlElement(this.element))return{x:Math.floor(this.offsetX-t.left),y:Math.floor(this.offsetY-t.top)};var e=vr.getClientPosition(this.element),n=this.element.tagName&&gr.isBodyElement(this.element);return{x:Math.floor(n?e.x+this.offsetX:e.x+this.offsetX-t.left),y:Math.floor(n?e.y+this.offsetY:e.y+this.offsetY-t.top)}},Ar.prototype._emulateEvents=function(t){var e,n,i=this.holdLeftButton?yr.BUTTONS_PARAMETER.leftButton:yr.BUTTONS_PARAMETER.noButton,o=p({x:this.x,y:this.y}),r={clientX:this.x,clientY:this.y,screenX:o.x,screenY:o.y,buttons:i,ctrl:this.modifiers.ctrl,alt:this.modifiers.alt,shift:this.modifiers.shift,meta:this.modifiers.meta,dataTransfer:this.dragAndDropState.dataTransfer},s={moveEvent:this.moveEvent,holdLeftButton:this.holdLeftButton},l=(e=this.dragAndDropState.enabled,n=this.firstMovingStepOccured,new(e?n?Jo:nr:jo)(s).run(t,rr(),r,this.dragElement,this.dragAndDropState.dataStore)),a=l.dragAndDropMode,u=l.dropAllowed;this.firstMovingStepOccured=!0,this.dragAndDropState.enabled=a,this.dragAndDropState.dropAllowed=u,sr(t)},Ar.prototype._movingStep=function(){var t,n=this;return this.touchMode&&!this.holdLeftButton?(this.x=this.endPoint.x,this.y=this.endPoint.y):this.startTime?(t=(Math.min(ar.dateNow(),this.endTime)-this.startTime)/(this.endTime-this.startTime),this.x=Math.floor(this.startPoint.x+this.distanceX*t),this.y=Math.floor(this.startPoint.y+this.distanceY*t)):(this.startTime=ar.dateNow(),this.endTime=this.startTime+this.movingTime,this.x+=0<this.distanceX?1:-1,this.y+=0<this.distanceY?1:-1),b.move(this.x,this.y).then(D).then(function(t){var e=n.holdLeftButton&&n.touchMode?n.dragElement:t;return e?n._emulateEvents(e):null}).then(No)},Ar.prototype._isMovingFinished=function(){return this.x===this.endPoint.x&&this.y===this.endPoint.y},Ar.prototype._move=function(){var t=this;return this.startPoint=b.position,this.x=this.startPoint.x,this.y=this.startPoint.y,this.distanceX=this.endPoint.x-this.startPoint.x,this.distanceY=this.endPoint.y-this.startPoint.y,this.movingTime=Math.max(Math.abs(this.distanceX),Math.abs(this.distanceY))/this.cursorSpeed,this.minMovingTime&&(this.movingTime=Math.max(this.movingTime,this.minMovingTime)),Sr.whilst(function(){return!t._isMovingFinished()},function(){return t._movingStep()})},Ar.prototype._scroll=function(){if(this.skipScrolling)return lr.resolve();var t=new uo({offsetX:this.offsetX,offsetY:this.offsetY},!1);return new f(this.element,t).run()},Ar.prototype._moveToCurrentFrame=function(){if(b.active)return lr.resolve();var t=b.position,e=t.x,n=t.y,i=b.activeWindow,o=null,r=null,s=null,l={cmd:Pr,startX:e,startY:n,endX:this.endPoint.x,endY:this.endPoint.y,modifiers:this.modifiers,speed:this.speed};return i.parent===Yu&&(o=gr.findIframeByWindow(i),s=vr.getIframeClientCoordinates(o),l.left=s.left,l.top=s.top,l.right=s.right,l.bottom=s.bottom),D().then(function(t){return r=t===o,i.parent===Yu&&(l.iframeUnderCursor=r),br(l,xr,i)}).then(function(t){return b.activeWindow=Yu,r||Yu.top!==Yu?b.move(t.x,t.y):null})},Ar.prototype.run=function(){var l=this;return D().then(function(t){l.dragElement=l.holdLeftButton?t:null;var e,n,i,o,r,s=function(t){for(var e=t;e;){if(e.draggable)return e;e=ar.nodeParentNodeGetter.call(e)}return null}(l.dragElement);return s&&ur.hasDataTransfer&&!l.skipDefaultDragBehavior&&(l.dragAndDropState.enabled=!0,l.dragElement=s,l.dragAndDropState.element=l.dragElement,l.dragAndDropState.dataStore=new pr,l.dragAndDropState.dataTransfer=new mr(l.dragAndDropState.dataStore),((e=gr.isAnchorElement(l.dragElement))||gr.isImgElement(l.dragElement))&&(n=e?"href":"src",o=(i=hr.parseProxyUrl(l.dragElement[n]))?i.destUrl:l.dragElement[n],r=cr.cleanUpHtml(ar.elementOuterHTMLGetter.call(l.dragElement)),l.dragAndDropState.dataTransfer.setData("text/plain",o),l.dragAndDropState.dataTransfer.setData("text/uri-list",o),l.dragAndDropState.dataTransfer.setData("text/html",r))),l._scroll()}).then(function(){var t=l._getTargetClientPoint(),e=t.x,n=t.y,i=Er.getWidth(Yu),o=Er.getHeight(Yu);return 0<=e&&e<=i&&0<=n&&n<=o?(l.endPoint={x:e,y:n},l._moveToCurrentFrame().then(function(){return l._move()})):null}).then(function(){return l.dragAndDropState})},Ar);function Ar(t,e){this.touchMode=ur.isTouchDevice,this.moveEvent=this.touchMode?"touchmove":"mousemove",this.holdLeftButton=e.holdLeftButton,this.dragElement=null,this.dragAndDropState=new Oo,this.automationSettings=new k(e.speed);var n=Ar.getTarget(t,e.offsetX,e.offsetY);this.element=n.element,this.offsetX=n.offsetX,this.offsetY=n.offsetY,this.speed=e.speed,this.cursorSpeed=this.holdLeftButton?this.automationSettings.draggingSpeed:this.automationSettings.cursorSpeed,this.minMovingTime=e.minMovingTime||null,this.modifiers=e.modifiers||{},this.skipScrolling=e.skipScrolling,this.skipDefaultDragBehavior=e.skipDefaultDragBehavior,this.endPoint=null,this.movingTime=null,this.x=null,this.y=null,this.startTime=null,this.endTime=null,this.distanceX=null,this.distanceY=null,this.firstMovingStepOccured=!1}var Cr,wr=h.utils.extend,Tr=function(t){var e=t.element,n=void 0===e?null:e,i=t.clientPoint,o=void 0===i?null:i,r=t.screenPoint,s=void 0===r?null:r,l=t.isTarget,a=void 0!==l&&l,u=t.inMoving,c=void 0!==u&&u;this.element=n,this.clientPoint=o,this.screenPoint=s,this.isTarget=a,this.inMoving=c,this.devicePoint=p(o)},Mr=(e(Ur,Cr=m.serviceUtils.EventEmitter),Ur.prototype._getElementForEvent=function(t){var e=t.point;return U(e.x,e.y,m.positionUtils.containsOffset(this.element,this.options.offsetX,this.options.offsetY)?this.element:null).then(function(t){return t.element})},Ur.prototype._moveToElement=function(){var t=this,e=new So(wr({skipScrolling:!0},this.options),!1);return new _r(this.element,e).run().then(function(){return m.delay(t.automationSettings.mouseActionStepDelay)})},Ur.prototype._scrollToElement=function(){var s=this,t=new uo(this.options),e=new f(this.element,t),l=!1;return e.run().then(function(t){return l=t,m.delay(s.automationSettings.mouseActionStepDelay)}).then(D).then(function(t){if(!t||!m.domUtils.contains(s.element,t)||!l)return null;var e=rr(),n=m.domUtils.getCommonAncestor(t,e),i=m.positionUtils.getClientPosition(t),o=p({x:i.x,y:i.y}),r={clientX:i.x,clientY:i.y,screenX:o.x,screenY:o.y,ctrl:!1,alt:!1,shift:!1,meta:!1,buttons:m.eventUtils.BUTTONS_PARAMETER.leftButton};return Ro.leaveElement(t,e,n,r),Ro.enterElement(t,e,n,r),sr(t),l})},Ur.prototype._getElementOffset=function(){var t=g(this.element),e=this.options,n=e.offsetX,i=e.offsetY;return{offsetX:n=n||0===n?n:t.offsetX,offsetY:i=i||0===i?i:t.offsetY}},Ur.prototype._wrapAction=function(t){var h=this,e=this._getElementOffset(),i=e.offsetX,o=e.offsetY,f=s(this.element,i,o),d=m.positionUtils.getClientPosition(this.element);return t().then(function(){var t,e,n,l=s(h.element,i,o),a=m.positionUtils.getClientPosition(h.element),u=(t=h.element,e=l,n=m.styleUtils.getElementScroll(t),!/html/i.test(t.tagName)&&m.styleUtils.hasScroll(t)&&(e.x-=n.left,e.y-=n.top),m.positionUtils.offsetToClientCoords(e)),c=m.positionUtils.containsOffset(h.element,i,o)?h.element:null;return U(u.x,u.y,c).then(function(t){var e=t.element,n=t.corrected,i=e;if(!i)return new Tr({});var o=(o=!c||n||i===h.element)||-1<m.arrayUtils.indexOf(m.domUtils.getParents(i),h.element),r=f.x!==l.x||f.y!==l.y,s=d.x!==a.x||d.y!==a.y;return new Tr({element:e,clientPoint:u,screenPoint:l,isTarget:o,inMoving:r&&s})})})},Ur._checkElementState=function(t,e){if(!t.element)throw new Error(I.elementIsInvisibleError);if(e&&(!t.isTarget||t.inMoving))throw new Error(I.foundElementIsNotTarget)},Ur.prototype._ensureElement=function(e,n){var i=this;return this._wrapAction(function(){return i._scrollToElement()}).then(function(t){return Ur._checkElementState(t,e)}).then(function(){return i._wrapAction(function(){return i._moveToElement()})}).then(function(t){return n||Ur._checkElementState(t,e),t}).then(function(t){return i.emit(i.TARGET_ELEMENT_FOUND_EVENT,{element:t.element}),{element:t.element,clientPoint:t.clientPoint,screenPoint:t.screenPoint,devicePoint:t.devicePoint}})},Ur);function Ur(t,e){var n=Cr.call(this)||this;return n.TARGET_ELEMENT_FOUND_EVENT="automation|target-element-found-event",n.element=t,n.options=e,n.automationSettings=new k(e.speed),n}var Dr=h.Promise,Ir=h.nativeMethods,kr=h.utils.browser,Br=h.eventSandbox.focusBlur,Nr=E.contentEditable,Or=E.textSelection,Yr=E.domUtils,Fr=E.styleUtils;function Lr(p,v,g){return new Dr(function(s){var t,l=Yr.getActiveElement(),e=Yr.isTextEditableElement(p),n=Yr.closest(p,"label[for]"),i=Yr.isElementFocusable(p),o=!i&&n,a=Yr.isContentEditableElement(p),r=a?Nr.findContentEditableParent(p):p;if(v&&kr.isWebKit&&e&&Or.select(p,0,0),o)return v&&(t=n,Yr.isElementFocusable(t)?Br.focus(t,E.noop,!1,!0):Xr(t)),void s();var u=!v,c=!1;if(!i&&!a){var h=Yr.findDocument(r),f=Ir.documentActiveElementGetter.call(h),d=Yr.isBodyElement(f),m=Yr.isBodyElement(r)?r:Yr.getFocusableParent(r);if(f&&!d&&Yr.containsElement(f,r)||d&&Yr.isBodyElement(m))return void s();r=m||h.body,c=!0}Br.focus(r,function(){var t,e,n,i,o,r;!v||a||p===Yr.getActiveElement()?(t=p,e=g,o=Yr.isTextEditableElement(t),r=Yr.isContentEditableElement(t),o||r?r&&isNaN(parseInt(e,10))?Or.setCursorToLastVisiblePosition(t):(n=isNaN(parseInt(e,10))?Yr.getElementValue(t).length:e,Or.select(t,n,n)):(i=Nr.findContentEditableParent(t))&&Or.setCursorToLastVisiblePosition(Nr.findContentEditableParent(i)),v||Yr.getActiveElement()===l?s():Br.focus(l,s,!0,!0)):s()},u,!0,!1,c)})}function Kr(t){var e=Yr.closest(t,"label[for]"),n=e&&(e.control||Fu.getElementById(e.htmlFor));return n&&Fr.isElementVisible(n)?n:null}function Xr(t){var e=Kr(t);e&&Yr.getActiveElement()!==e&&Br.focus(e,E.noop,!1,!0)}var Vr=h.utils.browser,Rr=h.eventSandbox.eventSimulator,Wr=h.eventSandbox.listeners,Hr=E.domUtils,Gr=E.styleUtils,zr=o.selectElement,qr=(jr.prototype.run=function(){this.eventState.clickElement&&Rr.click(this.eventState.clickElement,this.eventArgs.options),Hr.isElementFocusable(this.eventArgs.element)||Xr(this.eventArgs.element)},jr);function jr(t,e){this.eventState=t,this.eventArgs=e}var $r,Zr=(e(Jr,$r=qr),Jr.prototype.run=function(){function t(t){n=t.target===e.input}var e=this,n=!1;Wr.addInternalEventListener(Yu,["focus"],t),$r.prototype.run.call(this),Wr.removeInternalEventListener(Yu,["focus"],t),Hr.isElementFocusable(this.label)&&!n&&this._ensureBoundElementFocusRaised()},Jr.prototype._ensureBoundElementFocusRaised=function(){Rr.focus(this.input)},Jr);function Jr(t,e){var n=$r.call(this,t,e)||this;return n.label=n.eventArgs.element,n.input=Kr(n.eventArgs.element),n}var Qr,ts=(e(es,Qr=qr),es.prototype.run=function(){Qr.prototype.run.call(this),this._toggleSelectOptionList()},es.prototype._toggleSelectOptionList=function(){var t=this.eventArgs.element;1===Gr.getSelectElementSize(t)&&!1!==this.eventState.simulateDefaultBehavior&&(zr.isOptionListExpanded(t)?zr.collapseOptionList():zr.expandOptionList(t))},es);function es(t,e){return Qr.call(this,t,e)||this}var ns,is=(e(os,ns=qr),os.prototype.run=function(){return this.eventArgs.element},os);function os(t,e){return ns.call(this,t,e)||this}var rs,ss=(e(ls,rs=Zr),ls.prototype.run=function(){function t(){e=!0}var e=!1;Wr.addInternalEventListener(Yu,["change"],t),rs.prototype.run.call(this),Wr.removeInternalEventListener(Yu,["change"],t),Vr.isChrome&&!e&&this._ensureCheckboxStateChanged()},ls.prototype._ensureCheckboxStateChanged=function(){this.checkbox.checked=!this.checkbox.checked,Rr.change(this.checkbox)},ls);function ls(t,e){var n=rs.call(this,t,e)||this;return n.checkbox=n.input,n}var as,us=h.Promise,cs=h.utils.extend,hs=h.utils.browser,fs=h.utils.featureDetection,ds=h.eventSandbox.eventSimulator,ms=h.eventSandbox.listeners,ps=E.domUtils,vs=E.eventUtils,gs=E.arrayUtils,Es=E.delay,ys=(e(Ss,as=Mr),Ss.prototype._bindMousedownHandler=function(){var e=this,n=function(t){e.eventState.mousedownPrevented=t.defaultPrevented,vs.preventDefault(t),vs.unbind(e.element,"mousedown",n)};vs.bind(this.element,"mousedown",n)},Ss.prototype._bindBlurHandler=function(t){var e=this,n=function(){e.eventState.blurRaised=!0,vs.unbind(t,"blur",n,!0)};vs.bind(t,"blur",n,!0)},Ss.prototype._raiseTouchEvents=function(t){fs.isTouchDevice&&(ds.touchstart(t.element,t.options),ds.touchend(t.element,t.options))},Ss.prototype._mousedown=function(n){var i=this;return this.targetElementParentNodes=ps.getParents(n.element),this.mouseDownElement=n.element,b.leftButtonDown().then(function(){i._raiseTouchEvents(n);var t=ps.getActiveElement();i.activeElementBeforeMouseDown=t;var e=(hs.isWebKit||hs.isIE)&&ps.isSelectElement(i.mouseDownElement);return e&&i._bindMousedownHandler(),i._bindBlurHandler(t),i.eventState.simulateDefaultBehavior=ds.mousedown(n.element,n.options),!1===i.eventState.simulateDefaultBehavior&&(i.eventState.simulateDefaultBehavior=e&&!i.eventState.mousedownPrevented),i._ensureActiveElementBlur(t)}).then(function(){return i._focus(n)})},Ss.prototype._ensureActiveElementBlur=function(e){var n=this;return new us(function(t){ps.getActiveElement()===e||n.eventState.blurRaised?t():hs.isIE&&hs.version<12?No().then(function(){n.eventState.blurRaised||ds.blur(e),t()}):(ds.blur(e),t())})},Ss.prototype._focus=function(t){return!1===this.eventState.simulateDefaultBehavior?us.resolve():Lr(ps.isContentEditableElement(this.element)?this.element:t.element,!hs.isIE||this.activeElementBeforeMouseDown===ps.getActiveElement(),this.caretPos)},Ss._getElementForClick=function(t,e,n){var i=ps.getParents(e),o=ps.isTheSameNode(e,t);return hs.isFirefox?o?t:null:o?gs.equals(n,i)?t:null:t.contains(e)&&!ps.isEditableFormElement(e)?t:e.contains(t)?e:gs.getCommonElement(i,n)},Ss.prototype._mouseup=function(i){var o=this;return b.buttonUp().then(function(){return o._getElementForEvent(i)}).then(function(t){i.element=t,o.eventState.clickElement=Ss._getElementForClick(o.mouseDownElement,t,o.targetElementParentNodes);var e={},n=function(t){e=t.timeStamp,ms.removeInternalEventListener(Yu,["mouseup"],n)};return hs.isIE||ms.addInternalEventListener(Yu,["mouseup"],n),ds.mouseup(t,i.options),{timeStamp:e}})},Ss.prototype._click=function(t){var e,n,i,o,r,s,l;return e=this.eventState,i=Kr((n=t).element),o=Hr.isSelectElement(n.element),r=Hr.isOptionElement(n.element),s=Hr.isLabelElement(n.element)&&i,l=i&&Hr.isCheckboxElement(i),new(o?ts:r?is:l?ss:s?Zr:qr)(e,n).run(),t},Ss.prototype.run=function(t){var r=this,s=null;return this._ensureElement(t).then(function(t){var e=t.element,n=t.clientPoint,i=t.screenPoint,o=t.devicePoint;return s={point:n,screenPoint:i,element:e,options:cs({clientX:n.x,clientY:n.y,screenX:o.x,screenY:o.y},r.modifiers)},us.all([Es(r.automationSettings.mouseActionStepDelay),r._mousedown(s)])}).then(function(){return r._mouseup(s)}).then(function(t){var e=t.timeStamp;return s.options.timeStamp=e,r._click(s)})},Ss);function Ss(t,e){var n=as.call(this,t,e)||this;return n.modifiers=e.modifiers,n.caretPos=e.caretPos,n.targetElementParentNodes=[],n.activeElementBeforeMouseDown=null,n.mouseDownElement=null,n.eventState={mousedownPrevented:!1,blurRaised:!1,simulateDefaultBehavior:!0,clickElement:null},n}var bs=h.Promise,Ps=h.utils.browser,xs=h.utils.featureDetection,_s=h.eventSandbox.eventSimulator,As=h.eventSandbox.focusBlur,Cs=h.nativeMethods,ws=E.domUtils,Ts=E.styleUtils,Ms=E.delay,Us=o.selectElement,Ds=xs.isTouchDevice?0:160,Is=(ks.prototype._calculateEventArguments=function(){var t=this.optionListExpanded?Us.getEmulatedChildElement(this.element):this.element,e=1<Ts.getSelectElementSize(this.parentSelect);return{options:this.modifiers,element:Ps.isIE&&e?this.parentSelect:t}},ks.prototype._getMoveArguments=function(){var t,e,n=null,i=null,o=null;return o=this.optionListExpanded?(i=(t=v(n=Us.getEmulatedChildElement(this.element))).offsetX,t.offsetY):(n=Fu.documentElement,i=(e=Us.getSelectChildCenter(this.element)).x,e.y),{element:n,offsetX:i,offsetY:o,speed:this.speed}},ks.prototype._move=function(t){var e=this,n=t.element,i=t.offsetX,o=t.offsetY,r=t.speed,s=new So({offsetX:i,offsetY:o,speed:r,modifiers:this.modifiers},!1);return new _r(n,s).run().then(function(){return Ms(e.automationSettings.mouseActionStepDelay)})},ks.prototype._mousedown=function(){var t=this;return Ps.isFirefox?(_s.mousedown(this.eventsArgs.element,this.eventsArgs.options),this.clickCausesChange&&(this.parentSelect.selectedIndex=this.childIndex),this._focus()):Ps.isIE?(_s.mousedown(this.eventsArgs.element,this.eventsArgs.options),this._focus()):this._focus().then(function(){return Ms(Ds)}).then(function(){_s.mousedown(t.eventsArgs.element,t.eventsArgs.options),t.clickCausesChange&&(t.parentSelect.selectedIndex=t.childIndex)})},ks.prototype._focus=function(){var e=this;return new bs(function(t){As.focus(e.parentSelect,t,!1,!0)})},ks.prototype._mouseup=function(){var t=Ps.isIE?this.parentSelect:this.eventsArgs.element;_s.mouseup(t,this.eventsArgs.options),Ps.isIE&&this.clickCausesChange&&(this.parentSelect.selectedIndex=this.childIndex);var e=Ps.isFirefox||Ps.isSafari||Ps.isChrome&&53<=Ps.version,n=e||Ps.isIE;return e&&this.clickCausesChange&&_s.input(this.parentSelect),n&&this.clickCausesChange&&_s.change(this.parentSelect),bs.resolve()},ks.prototype._click=function(){_s.click(this.eventsArgs.element,this.eventsArgs.options)},ks.prototype.run=function(){var t=this;if(!this.parentSelect)return _s.click(this.eventsArgs.element,this.eventsArgs.options),bs.resolve();this.optionListExpanded||Us.scrollOptionListByChild(this.element);var e=this._getMoveArguments();return this.eventsArgs=this._calculateEventArguments(),Ts.getSelectElementSize(this.parentSelect)<=1?this._move(e).then(function(){return t._click()}):this._move(e).then(function(){return t._mousedown()}).then(function(){return t._mouseup()}).then(function(){return t._click()})},ks);function ks(t,e){var n,i,o,r,s;this.element=t,this.modifiers=e.modifiers,this.caretPos=e.caretPos,this.offsetX=e.offsetX,this.offsetY=e.offsetY,this.speed=e.speed,this.automationSettings=new k(e.speed),this.parentSelect=ws.getSelectParent(this.element),this.optionListExpanded=!!this.parentSelect&&Us.isOptionListExpanded(this.parentSelect),this.childIndex=null,this.clickCausesChange=!1,this.parentSelect&&(n=ws.isOptionElement(this.element),i=this.parentSelect.selectedIndex,this.childIndex=ws.getElementIndexInParent(this.parentSelect,this.element),o=Cs.nodeParentNodeGetter.call(this.element),r=ws.isOptionGroupElement(o)?o:null,s=this.element.disabled||r&&r.disabled,this.clickCausesChange=n&&!s&&this.childIndex!==i),this.eventsArgs={options:this.modifiers,element:this.element}}var Bs,Ns=h.utils.featureDetection,Os=h.utils.browser,Ys=h.eventSandbox.eventSimulator,Fs=E.eventUtils,Ls=E.delay,Ks=Ns.isTouchDevice?0:160,Xs=(e(Vs,Bs=Mr),Vs.prototype._firstClick=function(t){var e=this,n=new go(this.options);n.speed=1;var i=new ys(this.element,n);return i.on(i.TARGET_ELEMENT_FOUND_EVENT,function(t){return e.emit(e.TARGET_ELEMENT_FOUND_EVENT,t)}),i.run(t).then(function(t){return Ls(Ks).then(function(){return t})})},Vs.prototype._secondClick=function(t){var e=this;Os.isIE&&Fs.bind(Fu,"focus",Fs.preventDefault,!0);var n=new go({offsetX:t.screenPoint.x,offsetY:t.screenPoint.y,caretPos:this.caretPos,modifiers:this.modifiers,speed:1}),i=new ys(Fu.documentElement,n);return i.run().then(function(t){return e.eventState.dblClickElement=i.eventState.clickElement,Os.isIE&&Fs.unbind(Fu,"focus",Fs.preventDefault,!0),t})},Vs.prototype._dblClick=function(t){this.eventState.dblClickElement&&Ys.dblclick(this.eventState.dblClickElement,t.options)},Vs.prototype.run=function(t){var e=this;return this._firstClick(t).then(function(t){return e._secondClick(t)}).then(function(t){return e._dblClick(t)})},Vs);function Vs(t,e){var n=Bs.call(this,t,e)||this;return n.modifiers=e.modifiers,n.caretPos=e.caretPos,n.speed=e.speed,n.automationSettings=new k(n.speed),n.offsetX=e.offsetX,n.offsetY=e.offsetY,n.eventArgs=null,n.eventState={dblClickElement:null},n}var Rs,Ws=h.Promise,Hs=h.utils.extend,Gs=h.utils.featureDetection,zs=h.eventSandbox.eventSimulator,qs=h.eventSandbox.focusBlur,js=(e($s,Rs=Mr),$s.prototype._getEndPoint=function(){throw new Error("Not implemented")},$s.prototype._mousedown=function(t){var e=this;return b.leftButtonDown().then(function(){return e.simulateDefaultBehavior=zs[e.downEvent](t.element,t.options),e._focus(t)})},$s.prototype._focus=function(n){var i=this;return new Ws(function(t){var e=m.domUtils.isContentEditableElement(i.element)?m.contentEditable.findContentEditableParent(i.element):n.element;qs.focus(e,t,!1,!0)})},$s.prototype._getDestination=function(){throw new Error("Not implemented")},$s.prototype._drag=function(){var e=this,t=this._getDestination(),n=t.element,i=t.offsets,o=t.endPoint;this.endPoint=o;var r=new So({offsetX:i.offsetX,offsetY:i.offsetY,modifiers:this.modifiers,speed:this.speed,minMovingTime:25,holdLeftButton:!0,skipDefaultDragBehavior:!1===this.simulateDefaultBehavior},!1);return new _r(n,r).run().then(function(t){return e.dragAndDropState=t,m.delay(e.automationSettings.mouseActionStepDelay)})},$s.prototype._mouseup=function(){var r=this;return b.buttonUp().then(function(){var n=m.positionUtils.offsetToClientCoords(r.endPoint),i=null,o=Hs({clientX:n.x,clientY:n.y},r.modifiers);return U(n.x,n.y).then(function(t){var e=t.element;return(i=e)?(r.dragAndDropState.enabled?(o.dataTransfer=r.dragAndDropState.dataTransfer,r.dragAndDropState.dropAllowed&&zs.drop(i,o),zs.dragend(r.dragAndDropState.element,o),r.dragAndDropState.dataStore.setProtectedMode()):zs[r.upEvent](i,o),U(n.x,n.y)):i}).then(function(t){var e=t.element;i&&e===i&&!r.dragAndDropState.enabled&&zs.click(i,o)})})},$s.prototype.run=function(t){var i=this,o=null;return this._ensureElement(t).then(function(t){var e=t.element,n=t.clientPoint;return o={point:n,element:e,options:Hs({clientX:n.x,clientY:n.y},i.modifiers)},Ws.all([m.delay(i.automationSettings.mouseActionStepDelay),i._mousedown(o)])}).then(function(){return i._drag()}).then(function(){return i._mouseup()})},$s);function $s(t,e){var n=Rs.call(this,t,e)||this;return n.modifiers=e.modifiers,n.speed=e.speed,n.offsetX=e.offsetX,n.offsetY=e.offsetY,n.endPoint=null,n.simulateDefaultBehavior=!0,n.downEvent=Gs.isTouchDevice?"touchstart":"mousedown",n.upEvent=Gs.isTouchDevice?"touchend":"mouseup",n.dragAndDropState=null,n}var Zs,Js=E.styleUtils,Qs=(e(tl,Zs=js),tl.prototype._getDestination=function(){var t=s(this.element,this.offsetX,this.offsetY),e=Js.getWidth(Fu),n=Js.getHeight(Fu),i={x:t.x+this.dragOffsetX,y:t.y+this.dragOffsetY},i={x:Math.min(Math.max(0,i.x),e),y:Math.min(Math.max(0,i.y),n)};return{element:Fu.documentElement,offsets:{offsetX:i.x,offsetY:i.y},endPoint:i}},tl);function tl(t,e,n,i){var o=Zs.call(this,t,i)||this;return o.dragOffsetX=e,o.dragOffsetY=n,o}var el,nl=E.positionUtils,il=(e(ol,el=js),ol.prototype._getDestination=function(){var t=this.destinationElement,e=nl.getElementRectangle(t),n=g(t,this.destinationOffsetX,this.destinationOffsetY);return{element:t,offsets:n,endPoint:{x:e.left+n.offsetX,y:e.top+n.offsetY}}},ol);function ol(t,e,n){var i=el.call(this,t,n)||this;return i.destinationElement=e,i.destinationOffsetX=n.destinationOffsetX,i.destinationOffsetY=n.destinationOffsetY,i}var rl,sl=(e(ll,rl=Mr),ll.prototype.run=function(t){return this._ensureElement(t,!0)},ll);function ll(t,e){return rl.call(this,t,e)||this}var al=h.utils.browser,ul=h.sandbox.event,cl=h.eventSandbox.eventSimulator,hl=h.eventSandbox.listeners,fl=h.nativeMethods,dl=E.domUtils,ml=E.contentEditable,pl=E.textSelection,vl=/ /g;function gl(t){var e=pl.getSelectionByElement(t),n=pl.hasInverseSelectionContentEditable(t);return pl.hasElementContainsSelection(t)?ml.getSelection(t,e,n):{startPos:ml.calculateNodeAndOffsetByPosition(t,0),endPos:ml.calculateNodeAndOffsetByPosition(t,0)}}function El(t){var e=t.startPos.node,n=t.startPos.offset,i=t.endPos.offset,o=ml.getFirstNonWhitespaceSymbolIndex(e.nodeValue),r=ml.getLastNonWhitespaceSymbolIndex(e.nodeValue);return n<o&&0!==n?(t.startPos.offset=o,t.endPos.offset=i+o-n):r<i&&i!==e.nodeValue.length&&(t.startPos.offset=e.nodeValue.length,t.endPos.offset=i+e.nodeValue.length-n),t}function yl(t,e,n){return!n||cl.beforeInput(t,e)}function Sl(t,e){var n;function i(t){t.preventDefault(),n=!0}function o(t){"textInput"===t.type&&(n=!1)}al.isSafari&&(hl.addInternalEventListener(Yu,["textInput"],i),ul.on(ul.EVENT_PREVENTED_EVENT,o));var r=al.isFirefox||cl.textInput(t,e)||n;return al.isSafari&&(hl.removeInternalEventListener(Yu,["textInput"],i),ul.off(ul.EVENT_PREVENTED_EVENT,o)),r||al.isIE11}function bl(t,e){var n,i,o,r,s,l,a,u,c,h,f,d=gl(t),m=d.startPos.node,p=d.endPos.node,v=!0,g=!0,E=e;function y(){g=!1}function S(t,e,n){n()}e=e.replace(vl,String.fromCharCode(160)),m&&p&&dl.isContentEditableElement(m)&&dl.isContentEditableElement(p)&&(dl.isTheSameNode(m,p)||(pl.deleteSelectionContents(t),n=t,o=(i=d).startPos.node,r=fl.nodeParentNodeGetter.call(o)&&o.parentElement,!(al.isChrome&&al.version<58||al.isSafari)&&r&&dl.isElementContainsNode(n,o)||(i=gl(n),pl.hasInverseSelectionContentEditable(n)&&(i={startPos:i.endPos,endPos:i.startPos})),i.endPos.offset=i.startPos.offset,m=(d=i).startPos.node),m&&dl.isContentEditableElement(m)&&dl.isRenderedNode(m)&&yl(t,e,al.isChrome)&&(v=Sl(t,E),g=v&&!al.isIE11,hl.addInternalEventListener(Yu,["input"],y),hl.addInternalEventListener(Yu,["textinput"],S),(v=v&&yl(t,e,al.isSafari))&&(dl.isElementNode(m)?(s=m,l=e,c=Fu.createTextNode(l),h={node:c,offset:l.length},f=fl.nodeParentNodeGetter.call(s),"br"===dl.getTagName(s)?f.insertBefore(c,s):0<a?(u=fl.nodeChildNodesGetter.call(s),s.insertBefore(c,u[a])):s.appendChild(c),pl.selectByNodesAndOffsets(h,h)):function(t,e,n){var i=e.startPos.node;dl.isElementContainsNode(t,i)||(i=(e=El(gl(t))).startPos.node);var o=e.startPos.offset,r=e.endPos.offset,s=i.nodeValue,l={node:i,offset:o+n.length};i.nodeValue=s.substring(0,o)+n+s.substring(r,s.length),pl.selectByNodesAndOffsets(l,l)}(t,El(d),e)),No().then(function(){g&&cl.input(t),hl.removeInternalEventListener(Yu,["input"],y),hl.removeInternalEventListener(Yu,["textinput"],S)})))}function Pl(t,e,n){var i,o,r,s,l,a,u,c,h,f,d,m;dl.isContentEditableElement(t)&&bl(t,e),dl.isElementReadOnly(t)||(dl.isTextEditableElement(t)?(l=t,a=e,c=dl.getElementValue(l),h=a.length,f=pl.getSelectionStart(l),d=pl.getSelectionEnd(l),m=dl.isInputElement(l)&&"number"===l.type,yl(l,a,al.isChrome)&&Sl(l,a)&&yl(l,a,al.isSafari)&&((u=!al.isIE&&m?null:parseInt(l.maxLength,10))<0&&(u=al.isIE&&al.version<17?0:null),(null===u||isNaN(u)||u>c.length)&&(m&&al.isIOS&&"."===c[c.length-1]&&(f+=1,d+=1),dl.setElementValue(l,c.substring(0,f)+a+c.substring(d,c.length)),pl.select(l,f+h,f+h)),cl.input(l))):dl.isInputElement(t)&&(i=t,o=e,null!==(r=n)?(s=dl.getElementValue(i),dl.setElementValue(i,s.substr(0,r)+o+s.substr(r+o.length))):dl.setElementValue(i,o),cl.change(i),cl.input(i)))}function xl(t){return 1===t.length&&("a"<=t&&t<="z"||"A"<=t&&t<="Z")}var _l=h.nativeMethods,Al=h.utils.browser,Cl=h.eventSandbox.focusBlur,wl=h.Promise,Tl=m.domUtils.findDocument,Ml=m.domUtils.isRadioButtonElement,Ul=m.domUtils.getActiveElement;function Dl(t){return t===t.toLowerCase()?t.toUpperCase():t.toLowerCase()}function Il(t){var e=Ul(t||Fu),n=null;if(e&&m.domUtils.isIframeElement(e)&&_l.contentDocumentGetter.call(e))try{n=Il(_l.contentDocumentGetter.call(e))}catch(t){}return n||e}function kl(t,e,n){if(!Ml(e))return t;if(!n&&!e.name&&!Al.isChrome)return[e];var i,o,r=(i=e,o=null,n?""===i.name||Al.isFirefox||(o=function(t){return!t.name||t===i||t.name!==i.name}):""!==i.name?o=function(t){return Ml(t)&&t.name===i.name}:Al.isChrome&&(o=function(t){return Ml(t)&&!t.name}),o);return r&&(t=m.arrayUtils.filter(t,r)),t}function Bl(t,e,n){var i,o,r,s,l,a=e?-1:1,u=kl(u=m.domUtils.getFocusableElements(Tl(t),!0),t,n),c=Ml(t),h=m.arrayUtils.indexOf(u,t);return(e?0===h:h===u.length-1)?n||!c?Fu.body:u[u.length-1-h]:e&&-1===h?u[u.length-1]:(o=(i=u)[h+a],r=n,s=Ml(o)&&o.name&&!o.checked,l=null,r&&s&&(l=m.arrayUtils.find(i,function(t){return Ml(t)&&t.name===o.name&&t.checked})),l||o)}function Nl(t){if(xl(t))return t.toUpperCase().charCodeAt(0);var e=m.KEY_MAPS.shiftMap[t]?m.KEY_MAPS.shiftMap[t].charCodeAt(0):t.charCodeAt(0);return m.KEY_MAPS.symbolCharCodeToKeyCode[e]||e}var Ol={SPECIAL_KEYS:{capslock:"CapsLock",delete:"U+007F",end:"End",enter:"Enter",esc:"U+001B",home:"Home",ins:"Insert",pagedown:"PageDown",pageup:"PageUp",space:"U+0020",tab:"Tab",alt:"Alt",ctrl:"Control",meta:"Meta",shift:"Shift"},LETTERS:{a:"U+0041",b:"U+0042",c:"U+0043",d:"U+0044",e:"U+0045",f:"U+0046",g:"U+0047",h:"U+0048",i:"U+0049",j:"U+004A",k:"U+004B",l:"U+004C",m:"U+004D",n:"U+004E",o:"U+004F",p:"U+0050",q:"U+0051",r:"U+0052",s:"U+0053",t:"U+0054",u:"U+0055",v:"U+0056",w:"U+0057",x:"U+0058",y:"U+0059",z:"U+005A"},SYMBOLS:{0:"U+0030",1:"U+0031",2:"U+0032",3:"U+0033",4:"U+0034",5:"U+0035",6:"U+0036",7:"U+0037",8:"U+0038",9:"U+0039"," ":"U+0020","!":"U+0021","@":"U+0040","#":"U+0023",$:"U+0024","%":"U+0025","^":"U+005E","*":"U+002A","(":"U+0028",")":"U+0029",_:"U+005F","|":"U+007C","\\":"U+005C","/":"U+002F","?":"U+003F",".":"U+002E",",":"U+002C","<":"U+003C",">":"U+003E","[":"U+005B","]":"U+005D","{":"U+007B","}":"U+007D","":"U+00A7","":"U+00B1","'":"U+0027",'"':"U+0022",":":"U+003A",";":"U+003B","`":"U+0060","~":"U+007E"}};function Yl(t){return xl(t)?Ol.LETTERS[t.toLowerCase()]:Ol.SYMBOLS[t]||Ol.SPECIAL_KEYS[t]||t}function Fl(t,e,n){var i={};return"keyIdentifier"in KeyboardEvent.prototype&&(i.keyIdentifier=t?"":n),"key"in KeyboardEvent.prototype&&(i.key=e),i}var Ll=h.utils.browser,Kl=h.utils.extend,Xl=h.eventSandbox.eventSimulator,Vl=(Rl._isKeyActivatedInputElement=function(t){return m.domUtils.isInputElement(t)&&/button|submit|reset|radio|checkbox/.test(t.type)},Rl.prototype._type=function(t,e){var n,i=t!==this.storedActiveElement,o=!i,r=t,s=m.domUtils.isEditableElement(t),l=m.domUtils.isEditableElement(this.storedActiveElement);try{i&&(n=m.domUtils.isElementInIframe(t)===m.domUtils.isElementInIframe(this.storedActiveElement)||l,o=(!Ll.isFirefox||l)&&(!Ll.isWebKit||n))}catch(t){}o&&(!Ll.isIE&&i&&l&&s&&(r=this.storedActiveElement),Pl(r,e))},Rl.prototype._addKeyPropertyToEventOptions=function(t){return Kl(t,Fl("keypress"===t.type,this.keyProperty,this.keyIdentifierProperty)),t},Rl.prototype.down=function(t){this.storedActiveElement=Il(this.topSameDomainDocument),this.modifierKeyCode&&(t[this.sanitizedKey]=!0),t.shift&&this.isLetter&&(this.keyProperty=Dl(this.keyProperty));var e={keyCode:this.keyCode,type:"keydown"};return this._addKeyPropertyToEventOptions(e),Xl.keydown(this.storedActiveElement,Kl(e,t))},Rl.prototype.press=function(t){if(!this.isChar&&!this.specialKeyCode)return!0;var e=Il(this.topSameDomainDocument),n=this.isChar?function(t,e){if("space"===t)return" ";if(e){if(xl(t))return Dl(t);if(m.KEY_MAPS.reversedShiftMap[t])return m.KEY_MAPS.reversedShiftMap[t]}return t}(this.sanitizedKey,t.shift):null,i=this.specialKeyCode||n.charCodeAt(0),o=e!==this.storedActiveElement;if(Ll.isWebKit&&o&&m.domUtils.isElementInIframe(e)!==m.domUtils.isElementInIframe(this.storedActiveElement))return!0;this.storedActiveElement=e;var r={keyCode:i,charCode:i,type:"keypress"};this._addKeyPropertyToEventOptions(r);var s=Ll.isAndroid||Xl.keypress(e,Kl(r,t));if(!s)return s;e=Il(this.topSameDomainDocument),!n||t.ctrl||t.alt||this._type(e,n);var l=Rl._isKeyActivatedInputElement(e),a=m.domUtils.isButtonElement(e),u=Ll.isSafari&&0<=Ll.compareVersions([Ll.webkitVersion,"603.1.30"]);return Ll.isFirefox||u||!l&&!a||"enter"!==this.sanitizedKey||e.click(),s},Rl.prototype.up=function(t){this.modifierKeyCode&&(t[this.sanitizedKey]=!1);var e={keyCode:this.keyCode,type:"keyup"};this._addKeyPropertyToEventOptions(e);var n=Xl.keyup(Il(this.topSameDomainDocument),Kl(e,t)),i=Il(this.topSameDomainDocument);return!Ll.isFirefox&&!Ll.isSafari&&(!Ll.isChrome||53<=Ll.version)&&n&&"space"===this.sanitizedKey&&Rl._isKeyActivatedInputElement(i)&&i.click(),n},Object.defineProperty(Rl.prototype,"key",{get:function(){return this.sanitizedKey},enumerable:!1,configurable:!0}),Rl);function Rl(t,e){this.isLetter=xl(t),this.isChar=1===t.length||"space"===t,this.sanitizedKey=m.getSanitizedKey(t),this.modifierKeyCode=m.KEY_MAPS.modifiers[this.sanitizedKey],this.specialKeyCode=m.KEY_MAPS.specialKeys[this.sanitizedKey],this.keyCode=null,this.keyIdentifierProperty=Yl(e),this.topSameDomainDocument=m.domUtils.getTopSameDomainWindow(Yu).document,this.keyProperty=m.KEY_MAPS.keyProperty[e]||e,this.isChar&&"space"!==t?this.keyCode=Nl(this.sanitizedKey):this.modifierKeyCode?this.keyCode=this.modifierKeyCode:this.specialKeyCode&&(this.keyCode=this.specialKeyCode),this.storedActiveElement=null}var Wl=h.Promise,Hl=h.utils.browser,Gl=h.eventSandbox.eventSimulator,zl=h.eventSandbox.elementEditingWatcher,ql=E.textSelection,jl=E.eventUtils,$l=E.domUtils,Zl=o.selectElement,Jl=null,Ql=null;function ta(){Ql=Jl=null,jl.unbind(this,"blur",ta,!0)}function ea(t){var e,n,i,o;$l.isTextAreaElement(t)&&(Jl!==t&&(jl.bind(t,"blur",ta,!0),Jl=t),e=t,n=ql.hasInverseSelection(e),i=$l.getTextAreaValue(e),o=n?ql.getSelectionStart(e):ql.getSelectionEnd(e),Ql=i&&o?$l.getTextareaIndentInLine(e,o):0)}function na(t,e){var n,i,o,r,s,l,a=$l.getTextAreaValue(t);a&&(n=ql.getSelectionStart(t),i=ql.getSelectionEnd(t),o=ql.hasInverseSelection(t),s=(r=a.substring(0,o?n:i)).lastIndexOf("\n"),l=r.substring(0,s),null!==Ql&&Jl===t||ea(t),s=l.lastIndexOf("\n"),oa(t,n,i,o,Math.min(s+1+Ql,l.length),e))}function ia(t,e){var n,i,o,r,s,l,a,u,c,h,f=$l.getTextAreaValue(t);f&&(n=ql.getSelectionStart(t),i=ql.getSelectionEnd(t),u=(r=(o=ql.hasInverseSelection(t))?n:i)+(l=-1===(c=(s=f.substring(r)).indexOf("\n"))?s.length:c+1),h=-1===(c=(a=s.substring(l)).indexOf("\n"))?a.length:c,null!==Ql&&Jl===t||ea(t),oa(t,n,i,o,u=Math.min(u+Ql,u+h),e))}function oa(t,e,n,i,o,r){var s=null,l=null,l=r?(s=e!==n&&i?n:e,o):s=o;ql.select(t,s,l)}function ra(t,e,n){$l.isInputElement(t)&&"number"===t.type&&("-"===e.charAt(0)&&"."===e.charAt(1)&&(e=e.substring(1)),"."===e.charAt(e.length-1)&&(e=e.substring(0,e.length-1))),$l.setElementValue(t,e),ql.select(t,n,n),Gl.input(t)}function sa(t,e){var n,i,o,r,s,l,a,u;return $l.isTextEditableElement(t)&&(n=ql.getSelectionStart(t),i=ql.getSelectionEnd(t),o=ql.hasInverseSelection(t),s=null,s=(r=!$l.isTextAreaElement(t)||$l.getTextareaLineNumberByPosition(t,n)===$l.getTextareaLineNumberByPosition(t,i))?o?i:n:o?n:i,a=-1===(l=$l.getElementValue(t).substring(0,s).lastIndexOf("\n"))?0:l+1,u=null,r?(u=e?s:a,ql.select(t,u,a)):o?ql.select(t,i,a):ql.select(t,n,a)),Wl.resolve()}function la(t,e){var n,i,o,r,s,l,a,u,c;return $l.isTextEditableElement(t)&&(n=ql.getSelectionStart(t),i=ql.getSelectionEnd(t),o=ql.hasInverseSelection(t),s=null,u=s=(r=!$l.isTextAreaElement(t)||$l.getTextareaLineNumberByPosition(t,n)===$l.getTextareaLineNumberByPosition(t,i))?o?i:n:o?n:i,c=null,u+=-1===(a=(l=$l.getElementValue(t).substring(s)).indexOf("\n"))?l.length:a,r?(c=e?s:u,ql.select(t,c,u)):o?ql.select(t,i,u):ql.select(t,n,u)),Wl.resolve()}function aa(t){return sa(t,!0)}function ua(t){return la(t,!0)}function ca(t){return $l.isRadioButtonElement(t)&&!Hl.isFirefox}function ha(t,e){return fa(t,e,!1).then(function(t){t&&(t.checked=!0)})}function fa(t,e,n){return void 0===n&&(n=!0),t?($l.isSelectElement(t)&&Zl.collapseOptionList(),i=t,o=e,r=n,new wl(function(t){var e=Bl(i,o,r);e?Cl.focus(e,function(){return t(e)}):t()}).then(function(t){return t&&$l.isTextEditableInput(t)&&ql.select(t),t})):Wl.resolve();var i,o,r}var da={"ctrl+a":function(t){return $l.isEditableElement(t)&&ql.select(t),Wl.resolve()},backspace:function(t){var e,n,i;return $l.isTextEditableElementAndEditingAllowed(t)&&(e=ql.getSelectionStart(t),n=ql.getSelectionEnd(t),i=$l.getElementValue(t).replace(/\r\n/g,"\n"),n===e?0<e&&ra(t,i.substring(0,e-1)+i.substring(n,i.length),e-1):ra(t,i.substring(0,e)+i.substring(n,i.length),e)),$l.isContentEditableElement(t)&&ql.deleteSelectionContents(t),Wl.resolve()},delete:function(t){var e,n,i;return $l.isTextEditableElementAndEditingAllowed(t)&&(e=ql.getSelectionStart(t),n=ql.getSelectionEnd(t),i=$l.getElementValue(t).replace(/\r\n/g,"\n"),n===e?e<i.length&&ra(t,i.substring(0,e)+i.substring(n+1,i.length),e):ra(t,i.substring(0,e)+i.substring(n,i.length),e)),$l.isContentEditableElement(t)&&ql.deleteSelectionContents(t),Wl.resolve()},left:function(t){var e,n,i,o,r=null;return $l.isSelectElement(t)&&Zl.switchOptionsByKeys(t,"left"),ca(t)?ha(t,!0):($l.isTextEditableElement(t)&&(e=(r=ql.getSelectionStart(t)||0)===ql.getSelectionEnd(t)?r-1:r,ql.select(t,e,e),ea(t)),$l.isContentEditableElement(t)&&(r=ql.getSelectionStart(t))!==ql.getSelectionEnd(t)&&(n=ql.getSelectionByElement(t),o={node:(i=ql.hasInverseSelectionContentEditable(t))?n.focusNode:n.anchorNode,offset:i?n.focusOffset:n.anchorOffset},ql.selectByNodesAndOffsets(o,o,!0)),Wl.resolve())},right:function(t){var e,n,i,o,r=null,s=null;return $l.isSelectElement(t)&&Zl.switchOptionsByKeys(t,"right"),ca(t)?ha(t,!1):($l.isTextEditableElement(t)&&(e=(r=ql.getSelectionStart(t))===(s=ql.getSelectionEnd(t))?s+1:s,r===$l.getElementValue(t).length&&(e=r),ql.select(t,e,e),ea(t)),$l.isContentEditableElement(t)&&(r=ql.getSelectionStart(t))!==(s=ql.getSelectionEnd(t))&&(n=ql.getSelectionByElement(t),o={node:(i=ql.hasInverseSelectionContentEditable(t))?n.anchorNode:n.focusNode,offset:i?n.anchorOffset:n.focusOffset},ql.selectByNodesAndOffsets(o,o,!0)),Wl.resolve())},up:function(t){return $l.isSelectElement(t)&&Zl.switchOptionsByKeys(t,"up"),ca(t)?ha(t,!0):Hl.isWebKit&&$l.isInputElement(t)?sa(t):($l.isTextAreaElement(t)&&na(t,!1),Wl.resolve())},down:function(t){return $l.isSelectElement(t)&&Zl.switchOptionsByKeys(t,"down"),ca(t)?ha(t,!1):Hl.isWebKit&&$l.isInputElement(t)?la(t):($l.isTextAreaElement(t)&&ia(t,!1),Wl.resolve())},"shift+left":function(t){var e,n;return $l.isTextEditableElement(t)&&((e=ql.getSelectionStart(t))===(n=ql.getSelectionEnd(t))||ql.hasInverseSelection(t)?ql.select(t,n,Math.max(e-1,0)):ql.select(t,e,Math.max(n-1,0)),ea(t)),Wl.resolve()},"shift+right":function(t){var e,n,i;return $l.isTextEditableElement(t)&&(e=ql.getSelectionStart(t),n=ql.getSelectionEnd(t),i=$l.getElementValue(t).length,e!==n&&ql.hasInverseSelection(t)?ql.select(t,n,Math.min(e+1,i)):ql.select(t,e,Math.min(n+1,i)),ea(t)),Wl.resolve()},"shift+up":function(t){return Hl.isWebKit&&$l.isInputElement(t)?aa(t):($l.isTextAreaElement(t)&&na(t,!0),Wl.resolve())},"shift+down":function(t){return Hl.isWebKit&&$l.isInputElement(t)?ua(t):($l.isTextAreaElement(t)&&ia(t,!0),Wl.resolve())},"shift+home":aa,"shift+end":ua,home:sa,end:la,enter:function(t){var e,n,i,o,r,s;return $l.isSelectElement(t)&&Zl.collapseOptionList(),$l.isInputElement(t)?(Hl.isIE||zl.processElementChanging(t),(e=$l.getParents(t,"form")[0])&&function(t,e){var n=t.querySelectorAll("input, button"),i=null,o=null;for(o=0;o<n.length;o++)if(!i&&"submit"===n[o].type&&!n[o].disabled){i=n[o];break}if(i)Gl.click(i);else if($l.blocksImplicitSubmission(e)){for(var r=t.getElementsByTagName("input"),s=[],o=0;o<r.length;o++)$l.blocksImplicitSubmission(r[o])&&s.push(r[o]);1===s.length&&s[0]===e&&e.validity.valid&&Gl.submit(t)&&t.submit()}}(e,t)):$l.isTextAreaElement(t)?(n=ql.getSelectionStart(t),o=(i=$l.getTextAreaValue(t)).substring(0,n),r=i.substring(n),s=n+1,ra(t,o+String.fromCharCode(10)+r,s)):t.tagName&&$l.isAnchorElement(t)&&Gl.click(t),Wl.resolve()},tab:function(t){return fa(t,!1)},"shift+tab":function(t){return fa(t,!0)},esc:function(t){return $l.isSelectElement(t)&&Zl.collapseOptionList(),Wl.resolve()}},ma=h.Promise,pa=h.utils.browser,va=h.eventSandbox.message,ga=h.nativeMethods,Ea="automation|press|request",ya="automation|press|response";va.on(va.SERVICE_MSG_RECEIVED_EVENT,function(t){t.message.cmd===Ea&&(h.on(h.EVENTS.beforeUnload,function(){return va.sendServiceMsg({cmd:ya},t.source)}),new Sa(t.message.keyCombinations,t.message.options).run().then(function(){return va.sendServiceMsg({cmd:ya},t.source)}))});var Sa=(ba._getKeyPressSimulators=function(t){var e=function(t){for(var e=t.slice(),n=0;n<t.length;n++){var i=t[n];if("shift"===i.toLowerCase()){var o=t[n+1];if(!o)continue;m.KEY_MAPS.shiftMap[o]?t[n+1]=m.KEY_MAPS.shiftMap[o]:m.KEY_MAPS.reversedShiftMap[o]&&(e[n+1]=m.KEY_MAPS.reversedShiftMap[o])}!m.KEY_MAPS.shiftMap[i]||t[n-1]&&"shift"===t[n-1].toLowerCase()||(t[n]=m.KEY_MAPS.shiftMap[i],t.splice(n,0,"shift"),e.splice(n,0,"shift"),n++)}return{actualKeys:t,eventKeyProperties:e}}(m.getKeyArray(t)),n=e.actualKeys,i=e.eventKeyProperties;return m.arrayUtils.map(n,function(t,e){return new Vl(t,i[e])})},ba._getShortcuts=function(t){for(var e=m.getKeyArray(t.toLowerCase()),n=[],i=[],o=[],r=0;r<e.length;r++)for(i.push(e[r]),o=i.slice();o.length;){var s=o.join("+");da[s]?(n.push(s),i=o=[]):o.shift()}return n},ba._getShortcutHandlers=function(t){for(var e=ba._getShortcuts(t.toLowerCase()),n={},i="",o=null,r=null,s=null,l=0;l<e.length;l++)o=e[l],r=t.indexOf(o),s=o.length,n[i+=t.substring(0,r+s)]=da[o],t=t.substring(r+s);return n},ba.prototype._down=function(t){this.pressedKeyString+=(this.pressedKeyString?"+":"")+t.key;var e=!t.down(this.modifiersState);return ma.resolve(e)},ba.prototype._press=function(t,e){var n=this;if(e&&!this.isSelectElement)return m.delay(this.automationSettings.keyActionStepDelay);var i=this.shortcutHandlers[this.pressedKeyString],o=!1;return i&&!pa.isFirefox&&"enter"!==t.key||(o=!t.press(this.modifiersState)),o&&!this.isSelectElement||!i?m.delay(this.automationSettings.keyActionStepDelay):i(Il(this.topSameDomainDocument)).then(function(){return m.delay(n.automationSettings.keyActionStepDelay)})},ba.prototype._up=function(t){return t.up(this.modifiersState),m.delay(this.automationSettings.keyActionStepDelay)},ba.prototype._runCombination=function(t){var n=this;this.modifiersState={ctrl:!1,alt:!1,shift:!1,meta:!1},this.isSelectElement=m.domUtils.isSelectElement(Il(this.topSameDomainDocument)),this.pressedKeyString="",this.shortcutHandlers=ba._getShortcutHandlers(t);var e=ba._getKeyPressSimulators(t);return m.promiseUtils.each(e,function(e){return n._down(e).then(function(t){return n._press(e,t)})}).then(function(){return m.arrayUtils.reverse(e),m.promiseUtils.each(e,function(t){return n._up(t)})})},ba.prototype.run=function(){var e=this,t=m.domUtils.getActiveElement(),n=m.domUtils.isIframeElement(t);if(Yu.top===Yu&&n&&ga.contentWindowGetter.call(t)){var i={cmd:Ea,keyCombinations:this.keyCombinations,options:this.options};return m.sendRequestToFrame(i,ya,ga.contentWindowGetter.call(t))}return m.promiseUtils.each(this.keyCombinations,function(t){return e._runCombination(t).then(function(){return m.delay(e.automationSettings.keyActionStepDelay)})})},ba);function ba(t,e){this.keyCombinations=t,this.isSelectElement=!1,this.pressedKeyString="",this.modifiersState=null,this.shortcutHandlers=null,this.topSameDomainDocument=m.domUtils.getTopSameDomainWindow(Yu).document,this.automationSettings=new k(e.speed),this.options=e}var Pa,xa=h.Promise,_a=h.utils.extend,Aa=h.utils.browser,Ca=h.eventSandbox.eventSimulator,wa=E.domUtils,Ta=E.eventUtils,Ma=E.delay,Ua=(e(Da,Pa=Mr),Da.prototype._mousedown=function(t){var e=this;return b.rightButtonDown().then(function(){e.eventState.activeElementBeforeMouseDown=wa.getActiveElement(),e.eventState.simulateDefaultBehavior=Ca.mousedown(t.element,t.options)}).then(function(){return e._focus(t)})},Da.prototype._focus=function(t){return!1===this.simulateDefaultBehavior?No():Lr(wa.isContentEditableElement(this.element)?this.element:t.element,!Aa.isIE||this.eventState.activeElementBeforeMouseDown===wa.getActiveElement(),this.caretPos).then(No)},Da.prototype._mouseup=function(e){var t=this;return b.buttonUp().then(function(){return t._getElementForEvent(e)}).then(function(t){return Ca.mouseup(t,e.options)})},Da.prototype._contextmenu=function(e){return this._getElementForEvent(e).then(function(t){Ca.contextmenu(t,e.options),wa.isElementFocusable(t)||Xr(t)})},Da.prototype.run=function(t){var o=this,r=null;return this._ensureElement(t).then(function(t){var e=t.element,n=t.clientPoint,i=t.devicePoint;return r={point:n,element:e,options:_a({clientX:n.x,clientY:n.y,screenX:i.x,screenY:i.y,button:Ta.BUTTON.right},o.modifiers)},xa.all([Ma(o.automationSettings.mouseActionStepDelay),o._mousedown(r)])}).then(function(){return o._mouseup(r)}).then(function(){return o._contextmenu(r)})},Da);function Da(t,e){var n=Pa.call(this,t,e)||this;return n.modifiers=e.modifiers,n.caretPos=e.caretPos,n.eventState={simulateDefaultBehavior:!0,activeElementBeforeMouseDown:null},n}var Ia=h.utils.browser,ka=E.domUtils,Ba=E.positionUtils,Na=E.styleUtils,Oa=E.contentEditable,Ya=E.arrayUtils,Fa=["direction","font-family","font-size","font-size-adjust","font-variant","font-weight","font-style","letter-spacing","line-height","text-align","text-indent","text-transform","word-wrap","word-spacing","padding-top","padding-left","padding-right","padding-bottom","margin-top","margin-left","margin-right","margin-bottom","border-top-width","border-left-width","border-right-width","border-bottom-width"];function La(t,e){var n,i,o,r,s,l=Na.getBordersWidth(t),a=Ba.getOffsetPosition(t),u=t.scrollHeight||t.getBoundingClientRect().height,c=Math.ceil(e.left),h=Math.ceil(e.top),f=Math.floor(e.bottom);return ka.isTextAreaElement(t)||(i=(n=Ba.offsetToClientCoords({x:a.left,y:a.top})).x+l.left+1,o=n.y+l.top+1,r=n.y+l.top+l.bottom+u,s=n.y+l.top+u-1,c=Math.ceil(c<=n.x?i:e.left),h=Math.ceil(h<=n.y?o:e.top),f=Math.floor(r<=f?s:e.bottom)),{left:c,top:h,bottom:f}}function Ka(t){var e=Na.getElementScroll(Fu);return{left:t.left+e.left,top:t.top+e.top,bottom:t.bottom+e.top}}function Xa(t,e){var n=t.getBoundingClientRect(),i=function(e){var t,n,i,o=Fu.body,r=Ba.getOffsetPosition(e),s=Na.getElementMargin(e),l=r.top-s.top,a=r.left-s.left,u=Fu.createElement("div"),c="white-space:pre-wrap;border-style:solid;";return"absolute"===Na.get(o,"position")&&(t=Na.getElementMargin(o),n=Na.get(o,"left"),i=Na.get(o,"top"),a-=t.left+(parseInt(n.replace("px",""),10)||0),l-=t.top+(parseInt(i.replace("px",""),10)||0)),Ya.forEach(Fa,function(t){c+=t+":"+Na.get(e,t)+";"}),Na.set(u,{cssText:c,position:"absolute",left:a+"px",top:l+"px",width:e.scrollWidth+"px",height:e.scrollHeight+"px"}),h.nativeMethods.nodeTextContentSetter.call(u,ka.getElementValue(e)+" "),o.appendChild(u),u}(t),o=null,r=t.getBoundingClientRect(),s=r.top-n.top,l=r.left-n.left,a=ka.getElementValue(t).length;try{var u=Fu.createRange();u.setStart(h.nativeMethods.nodeFirstChildGetter.call(i),Math.min(e,a)),u.setEnd(h.nativeMethods.nodeFirstChildGetter.call(i),Math.min(e+1,a+1)),ka.isTextAreaElement(t)&&(0!==(o=u.getBoundingClientRect()).width||0!==o.height)||(o=u.getClientRects()[0])}catch(t){o=null}return ka.remove(i),o?{width:o.width,height:o.height,top:o.top-s,bottom:o.bottom-s,left:o.left-l,right:o.right-l}:null}function Va(t,e){var n,i,o,r,s,l,a=null;return(a=ka.isContentEditableElement(t)?(o=t,r=e,s=ka.findDocument(o).createRange(),l=Oa.calculateNodeAndOffsetByPosition(o,r),s.setStart(l.node,Math.min(l.offset,l.node.length)),s.setEnd(l.node,Math.min(l.offset,l.node.length)),s.getClientRects()[0]):"function"==typeof t.createTextRange?(n=e,(i=t.createTextRange()).collapse(!0),i.moveStart("character",n),i.moveEnd("character",n),i.collapse(!0),i.getBoundingClientRect()):Xa(t,e))?{x:(a=Ka(a=La(t,a))).left,y:Math.floor(a.top+(a.bottom-a.top)/2)}:null}function Ra(t,e){var n=ka.isTextEditableElement(t),i=ka.isContentEditableElement(t);return n&&0<ka.getElementValue(t).length||i&&Oa.getContentEditableValue(t).length?Va(t,e):Ba.findCenter(t)}function Wa(t,e,n){var i=ka.findDocument(t).createRange();i.setStart(e,Math.min(n,e.length)),i.setEnd(e,Math.min(n,e.length));var o=i.getClientRects()[0];return o?{x:(o=Ka(o=La(t,o))).left,y:Math.floor(o.top+(o.bottom-o.top)/2)}:null}var Ha,Ga=h.Promise,za=h.utils.browser,qa=h.utils.featureDetection,ja=h.eventSandbox.eventSimulator,$a=h.eventSandbox.focusBlur,Za=E.contentEditable,Ja=E.domUtils,Qa=E.positionUtils,tu=E.eventUtils,eu=E.delay,nu=(e(iu,Ha=Mr),iu._calculateEventArguments=function(t){var n=Qa.offsetToClientCoords(t);return U(n.x,n.y).then(function(t){var e=t.element;if(!e)throw new Error(I.elementIsInvisibleError);return{element:e,options:{clientX:n.x,clientY:n.y}}})},iu.prototype._move=function(t){var e=this,n=t.element,i=t.offsetX,o=t.offsetY,r=t.speed,s=new So({offsetX:i,offsetY:o,speed:r},!1);return new _r(n,s).run().then(function(){return eu(e.automationSettings.mouseActionStepDelay)})},iu.prototype._bindMousedownHandler=function(){var e=this,n=function(t){e.eventState.mousedownPrevented=t.defaultPrevented,tu.preventDefault(t),tu.unbind(e.element,"mousedown",n)};tu.bind(this.element,"mousedown",n)},iu.prototype._calculateAbsoluteStartPoint=function(){throw new Error("Not implemented")},iu.prototype._calculateAbsoluteEndPoint=function(){throw new Error("Not implemented")},iu.prototype._moveToPoint=function(t){!function(t,e){if(ka.isEditableElement(t)){var n=ka.isTextAreaElement(t);if(!ka.isInputElement(t)||!(Ia.isFirefox||Ia.isIE&&10<Ia.version)){var i=Ba.getOffsetPosition(t),o=Na.getBordersWidth(t),r=Na.getElementScroll(t),s=e.x-i.left-o.left,l=e.y-i.top-o.top,a=null;if(n)return l<r.top&&(a=l),l>t.clientHeight+r.top&&(a=l-t.clientHeight),null!==a&&Na.setScrollTop(t,Math.round(a));s<r.left&&(a=s),s>t.clientWidth+r.left&&(a=s-t.clientWidth),null!==a&&Na.setScrollLeft(t,Math.round(a))}}}(this.element,t),this.clientPoint=function(t,e){var n=ka.isTextEditableElement(t),i=ka.isInputElement(t);if(!n&&!ka.isContentEditableElement(t))return e;var o=Ba.getOffsetPosition(t),r=Na.getBordersWidth(t),s=Na.getElementScroll(t),l=o.left+r.left+t.clientWidth;return i&&n&&(Ia.isFirefox||Ia.isIE&&10<Ia.version)?{x:Math.min(e.x,l),y:e.y}:{x:e.x-s.left,y:e.y-s.top}}(this.element,t);var e={element:Fu.documentElement,offsetX:this.clientPoint.x,offsetY:this.clientPoint.y,speed:this.speed};return this._move(e)},iu.prototype._mousedown=function(){var n=this;return b.leftButtonDown().then(function(){return iu._calculateEventArguments(n.clientPoint)}).then(function(t){n.eventArgs=t;var e=(za.isWebKit||za.isIE)&&Ja.isSelectElement(n.element);return e&&n._bindMousedownHandler(),n.eventState.simulateDefaultBehavior=ja[n.downEvent](n.eventArgs.element,n.eventArgs.options),!1===n.eventState.simulateDefaultBehavior&&(n.eventState.simulateDefaultBehavior=e&&!n.eventState.mousedownPrevented),n._focus()})},iu.prototype._focus=function(){var n=this;return new Ga(function(t){var e=Ja.isContentEditableElement(n.element)?Za.findContentEditableParent(n.element):n.element;$a.focus(e,t,!1,!0)})},iu.prototype._setSelection=function(){throw new Error("Not implemented")},iu.prototype._mouseup=function(){var e=this;return b.buttonUp().then(function(){return e._setSelection(),iu._calculateEventArguments(e.clientPoint)}).then(function(t){e.eventArgs=t,ja[e.upEvent](e.eventArgs.element,e.eventArgs.options)})},iu.prototype.run=function(){var t=this;return this.absoluteStartPoint=this._calculateAbsoluteStartPoint(),this.absoluteEndPoint=this._calculateAbsoluteEndPoint(),this._moveToPoint(this.absoluteStartPoint).then(function(){return t._mousedown()}).then(function(){return t._moveToPoint(t.absoluteEndPoint)}).then(function(){return t._mouseup()})},iu);function iu(t,e){var n=Ha.call(this,t,e)||this;return n.absoluteStartPoint=null,n.absoluteEndPoint=null,n.clientPoint=null,n.speed=e.speed,n.downEvent=qa.isTouchDevice?"touchstart":"mousedown",n.upEvent=qa.isTouchDevice?"touchend":"mouseup",n.eventArgs={options:null,element:null},n.eventState={mousedownPrevented:!1,simulateDefaultBehavior:!0},n}var ou,ru=E.textSelection,su=E.domUtils,lu=E.positionUtils,au=(e(uu,ou=nu),uu.prototype._calculateAbsoluteStartPoint=function(){return Ra(this.element,this.startPos)||lu.findCenter(this.element)},uu.prototype._calculateAbsoluteEndPoint=function(){var t=Ra(this.element,this.endPos);return t||(su.isContentEditableElement(this.element)?function(t,e,n){for(var i=n<e?1:-1,o=n,r=null;o!==e&&!(r=Va(t,o+=i)););return r=r||Va(t,e)||Ba.findCenter(t)}(this.element,this.startPos,this.endPos):lu.findCenter(this.element))},uu.prototype._setSelection=function(){var t=su.isTextEditableElement(this.element),e=su.isContentEditableElement(this.element);(t||e)&&!1!==this.eventState.simulateDefaultBehavior&&ru.select(this.element,this.startPos,this.endPos)},uu.prototype.run=function(t){var e=this;return this._ensureElement(t).then(function(){return ou.prototype.run.call(e)})},uu);function uu(t,e,n,i){var o=ou.call(this,t,i)||this;return o.startPos=e,o.endPos=n,o}var cu,hu=E.textSelection,fu=E.contentEditable,du=E.positionUtils,mu=(e(pu,cu=nu),pu.prototype._calculateAbsoluteStartPoint=function(){return Wa(this.element,this.startNode,this.startOffset)||du.findCenter(this.element)},pu.prototype._calculateAbsoluteEndPoint=function(){return Wa(this.element,this.endNode,this.endOffset)||du.findCenter(this.element)},pu.prototype._setSelection=function(){var t,e;!1!==this.eventState.simulateDefaultBehavior&&(t={node:this.startNode,offset:this.startOffset},e={node:this.endNode,offset:this.endOffset},hu.selectByNodesAndOffsets(t,e,!0))},pu);function pu(t,e,n){var i=cu.call(this,fu.getNearestCommonAncestor(t,e),n)||this,o=fu.getFirstVisiblePosition(t),r=fu.getLastVisiblePosition(e),s={node:t,offset:o},l={node:e,offset:r},a=fu.calculatePositionByNodeAndOffset(i.element,s);return fu.calculatePositionByNodeAndOffset(i.element,l)<a&&(o=fu.getLastVisiblePosition(t),r=fu.getFirstVisiblePosition(e)),s=fu.calculateNodeAndOffsetByPosition(t,o),l=fu.calculateNodeAndOffsetByPosition(e,r),i.startNode=s.node,i.startOffset=s.offset,i.endNode=l.node,i.endOffset=l.offset,i}var vu=h.Promise,gu=h.utils.extend,Eu=h.utils.browser,yu=h.eventSandbox.eventSimulator,Su=h.eventSandbox.elementEditingWatcher,bu=E.domUtils,Pu=E.promiseUtils,xu=E.contentEditable,_u=E.textSelection,Au=E.delay,Cu=E.KEY_MAPS.specialKeys,wu=(Tu.findTextEditableChild=function(t){var e=null;if(!bu.isEditableElement(t))for(var n=t.querySelectorAll("*"),i=0;i<n.length;i++)if(bu.isTextEditableElementAndEditingAllowed(n[i])){e=n[i];break}return e},Tu.prototype._calculateEventArguments=function(t){var e=bu.getActiveElement(),n=bu.isContentEditableElement(this.element),i=this.eventArgs.element||this.element;n||e===i||(i=Tu.findTextEditableChild(e)||e);var o=gu({keyCode:t?this.currentCharCode:this.currentKeyCode},this.modifiers);return t&&(o.charCode=this.currentCharCode),gu(o,Fl(t,this.currentKey,this.currentKeyIdentifier)),{element:i,options:o}},Tu.prototype._calculateTargetElement=function(){var t=bu.getActiveElement(),e=bu.isContentEditableElement(this.element);if(e){if(t!==xu.findContentEditableParent(this.element))return void(this.eventState.skipType=!0)}else if(t!==this.element)return void(this.eventState.skipType=!0);this.element=e?this.element:t},Tu.prototype._click=function(t){var e,n=this,i=bu.getActiveElement(),o=bu.isTextEditableElementAndEditingAllowed(this.element),r=bu.isContentEditableElement(this.element);if(i===this.element)return o&&Su.watchElementEditing(this.element),(o||r)&&(e=_u.getSelectionStart(this.element),isNaN(parseInt(this.caretPos,10))||this.caretPos===e||_u.select(this.element,this.caretPos,this.caretPos)),vu.resolve();var s=v(this.element),l=s.offsetX,a=s.offsetY,u=new go({offsetX:this.elementChanged?l:this.offsetX,offsetY:this.elementChanged?a:this.offsetY,speed:this.speed,caretPos:this.caretPos,modifiers:this.modifiers});return new ys(this.element,u).run(t).then(function(){return Au(n.automationSettings.mouseActionStepDelay)})},Tu.prototype._type=function(){var t=this;if(this.eventState.skipType)return vu.resolve();var e=bu.isContentEditableElement(this.element);return this.replace&&(bu.isTextEditableElementAndEditingAllowed(this.element)?_u.select(this.element):e&&_u.deleteSelectionContents(this.element,!0)),Pu.whilst(function(){return!t._isTypingFinished()},function(){return t._typingStep()})},Tu.prototype._isTypingFinished=function(){return this.currentPos===this.typingText.length},Tu.prototype._typingStep=function(){var t=this.typingText.charAt(this.currentPos);return this.currentKeyCode=Nl(t),this.currentCharCode=this.typingText.charCodeAt(this.currentPos),this.currentKey=this.currentKeyCode===Cu.enter?"Enter":t,this.currentKeyIdentifier=Yl(this.currentKey),this._keydown(),this._keypress(),this._keyup()},Tu.prototype._keydown=function(){this.eventArgs=this._calculateEventArguments(),this.eventState.simulateKeypress=yu.keydown(this.eventArgs.element,this.eventArgs.options)},Tu.prototype._keypress=function(){!1!==this.eventState.simulateKeypress&&(this.eventArgs=this._calculateEventArguments(!0),this.eventState.simulateTypeChar=Eu.isAndroid||yu.keypress(this.eventArgs.element,this.eventArgs.options))},Tu.prototype._keyup=function(){var t=this,e=this.eventArgs.element;this.eventArgs=this._calculateEventArguments();var n=bu.isTextEditableElement(this.element),i=bu.isContentEditableElement(this.element),o=this.paste||!n&&!i;return vu.resolve().then(function(){return o?t._typeAllText(e):t._typeChar(e)}).then(function(){yu.keyup(t.eventArgs.element,t.eventArgs.options),o?t.currentPos=t.typingText.length:t.currentPos++})},Tu.prototype._typeChar=function(t){if(!1===this.eventState.simulateKeypress||!1===this.eventState.simulateTypeChar)return Su.restartWatchingElementEditing(t),Au(this.automationSettings.keyActionStepDelay);var e=this.typingText.charAt(this.currentPos),n=/^\d$/.test(e),i=0===this.currentPos?null:this.typingText.charAt(this.currentPos-1);if(bu.isInputElement(t)&&"number"===t.type){var o=_u.getSelectionStart(t),r=bu.getInputValue(t).length,s=/^\d/.test(this.typingText);if(!n&&(s||!("."===e||"-"===e&&r)||0!==o))return Au(this.automationSettings.keyActionStepDelay);n&&("."===i||"-"===i&&!r)&&(e=i+e)}return Pl(t,e,null),Au(this.automationSettings.keyActionStepDelay)},Tu.prototype._typeAllText=function(t){return Pl(t,this.typingText,this.caretPos),Au(this.automationSettings.keyActionStepDelay)},Tu.prototype.run=function(t){var e=this;return this._click(t).then(function(){return e._calculateTargetElement()}).then(function(){return e._type()})},Tu);function Tu(t,e,n){this.element=Tu.findTextEditableChild(t)||t,this.typingText=e.toString(),this.modifiers=n.modifiers,this.caretPos=n.caretPos,this.replace=n.replace,this.paste=n.paste,this.offsetX=n.offsetX,this.offsetY=n.offsetY,this.speed=n.speed,this.automationSettings=new k(this.speed),this.elementChanged=t!==this.element,this.currentPos=0,this.currentKeyCode=null,this.currentCharCode=null,this.currentKey=null,this.currentKeyIdentifier=null,this.eventArgs={options:null,element:null},this.eventState={skipType:!1,simulateKeypress:!0,simulateTypeChar:!0}}var Mu=(Uu.prototype.run=function(){var i=this;return t.doUpload(this.element,this.paths).then(function(t){if(t.length){var e=m.arrayUtils.map(t,function(t){return t.path}),n=m.arrayUtils.reduce(t,function(t,e){return t.concat(e.resolvedPaths)},[]);throw i.createError(e,n)}})},Uu);function Uu(t,e,n){this.element=t,this.paths=e,this.createError=n}var Du=E.domUtils,Iu=E.contentEditable,ku={};ku.Scroll=f,ku.Click=ys,ku.SelectChildClick=Is,ku.DblClick=Xs,ku.DragToOffset=Qs,ku.DragToElement=il,ku.Hover=sl,ku.Press=Sa,ku.RClick=Ua,ku.SelectText=au,ku.SelectEditableContent=mu,ku.Type=wu,ku.Upload=Mu,ku.MouseOptions=mo,ku.ClickOptions=go,ku.TypeOptions=Co,ku.ERROR_TYPES=I,ku.AutomationSettings=k,ku.getOffsetOptions=g,ku.calculateSelectTextArguments=function(t,e){void 0===e&&(e={});var n,i,o,r,s,l,a,u,c,h,f,d=Du.isTextEditableElement(t),m=d?0:Iu.getFirstVisiblePosition(t),p=d?Du.getElementValue(t).length:Iu.getLastVisiblePosition(t),v=e.startPos?Math.min(e.startPos,p):m,g=void 0===e.endPos||null===e.endPos?p:Math.min(e.endPos,p);return void 0!==e.offset?(g=0<=e.offset?Math.min(e.offset,g):(v=g,Math.max(0,g+e.offset)),{startPos:v,endPos:g}):void 0!==e.startLine?(n=t,i=e,o=Du.getTextAreaValue(n),r=o&&o.length?o.split("\n"):[],s=r.length-1,l=i.startLine?Math.min(i.startLine,s):0,a=r[l]?r[l].length:0,u=i.startPos?Math.min(i.startPos,a):0,c=void 0===i.endLine||null===i.endLine?s:Math.min(i.endLine,s),h=r[c]?r[c].length:0,f=void 0===i.endPos||null===i.endPos?h:Math.min(i.endPos,h),{startPos:Du.getTextareaPositionByLineAndOffset(n,l,0)+u,endPos:Du.getTextareaPositionByLineAndOffset(n,c,0)+f}):{startPos:v,endPos:g}},ku.cursor=b,ku.getNextFocusableElement=Bl,ku.getSelectionCoordinatesByPosition=Ra,ku.getElementFromPoint=U;var Bu=h.nativeMethods,Nu=h.EVENTS.evalIframeScript;Bu.objectDefineProperty(Yu,"%testCafeAutomation%",{configurable:!0,value:ku}),h.on(Nu,function(t){return Ou(Bu.contentWindowGetter.call(t.iframe))})}(Yu["%hammerhead%"],Yu["%testCafeCore%"],Yu["%testCafeUI%"])}(window);